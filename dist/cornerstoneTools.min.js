/*! cornerstone-tools - 0.9.0 - 2017-10-09 | (c) 2017 Chris Hafey | https://github.com/chafey/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cornerstone-core"),require("cornerstone-math"),require("hammerjs"),require("jquery")):"function"==typeof define&&define.amd?define("cornerstoneTools",["cornerstone-core","cornerstone-math","hammerjs","jquery"],t):"object"==typeof exports?exports.cornerstoneTools=t(require("cornerstone-core"),require("cornerstone-math"),require("hammerjs"),require("jquery")):e.cornerstoneTools=t(e.cornerstone,e.cornerstoneMath,e.Hammer,e.$)}(this,function(e,t,o,a){return function(e){function t(a){if(o[a])return o[a].exports;var n=o[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=111)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(118);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(121),n=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=n.default},function(e,t,o){"use strict";function a(e){var t=c.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=g.globalImageIdSpecificToolStateManager),t.toolStateManager}function n(e,t,o){a(e).add(e,t,o);var n={toolType:t,element:e,measurementData:o};(0,d.default)(e).trigger("CornerstoneToolsMeasurementAdded",n)}function r(e,t){return a(e).get(e,t)}function l(e,t,o){for(var n=a(e),r=n.get(e,t),l=-1,i=0;i<r.data.length;i++)r.data[i]===o&&(l=i);if(-1!==l){r.data.splice(l,1);var u={toolType:t,element:e,measurementData:o};(0,d.default)(e).trigger("CornerstoneToolsMeasurementRemoved",u)}}function i(e,t){var o=a(e),n=o.get(e,t);void 0!==n&&(n.data=[])}function u(e,t){c.getEnabledElement(e).toolStateManager=t}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var s=o(1),d=function(e){return e&&e.__esModule?e:{default:e}}(s),f=o(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(f),g=o(17);t.addToolState=n,t.getToolState=r,t.removeToolState=l,t.clearToolState=i,t.setElementToolStateManager=u,t.getElementToolStateManager=a},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(119);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,o){"use strict";function a(e){c=e}function n(){return c}function r(e){d=e}function l(){return d}function i(e){f=e}function u(){return f}function s(e){return e?f:d}Object.defineProperty(t,"__esModule",{value:!0});var d="white",f="greenyellow",c="transparent",g={setFillColor:a,getFillColor:n,setToolColor:r,getToolColor:l,setActiveColor:i,getActiveColor:u,getColorIfActive:s};t.default=g},function(e,t,o){"use strict";function a(e){i=e}function n(){return i}function r(e){u=e}function l(){return u}Object.defineProperty(t,"__esModule",{value:!0});var i=1,u=2,s={setToolWidth:a,getToolWidth:n,setActiveWidth:r,getActiveWidth:l};t.default=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r,l){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var i=n.default.getFont(),u=n.default.getFontSize(),s=n.default.getBackgroundColor();e.save(),e.font=i,e.textBaseline="top",e.strokeStyle=r;var d=0;t.forEach(function(t){var o=e.measureText(t).width;d=Math.max(d,o)}),e.fillStyle=s;var f={width:d+10,height:5+t.length*(u+5)};return l&&l.centering&&!0===l.centering.x&&(o-=f.width/2),l&&l.centering&&!0===l.centering.y&&(a-=f.height/2),f.left=o,f.top=a,l&&!0===l.debug&&(e.fillStyle="#FF0000"),e.fillRect(f.left,f.top,f.width,f.height),t.forEach(function(t,n){e.fillStyle=r,e.fillText(t,o+5,a+5+n*(u+5))}),e.restore(),f};var a=o(15),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var l=t.element,u=e.createNewMeasurement(t);if(u){var s={mouseButtonMask:t.which};(0,P.addToolState)(t.element,e.toolType,u),(0,r.default)(l).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,r.default)(l).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),(0,r.default)(l).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&(0,r.default)(l).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),i.updateImage(l);var d=void 0;d=1===Object.keys(u.handles).length?m.default:p.default;var f=void 0;f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,d(t,e.toolType,u,u.handles.end,function(){u.active=!1,u.invalidated=!0,(0,b.default)(t,u.handles)&&(0,P.removeToolState)(l,e.toolType,u),(0,r.default)(l).on("CornerstoneToolsMouseMove",s,e.mouseMoveCallback||a),(0,r.default)(l).on("CornerstoneToolsMouseDown",s,e.mouseDownCallback||n),(0,r.default)(l).on("CornerstoneToolsMouseDownActivate",s,e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&(0,r.default)(l).on("CornerstoneToolsMouseDoubleClick",s,e.mouseDoubleClickCallback),i.updateImage(l)},f)}}function o(o,a){if((0,x.default)(a.which,o.data.mouseButtonMask))return e.addNewMeasurement?e.addNewMeasurement(a):t(a),!1}function a(t,o){if(s.default.setCoords(o),0===o.which){var a=(0,P.getToolState)(o.element,e.toolType);if(a){for(var n=!1,r=0;r<a.data.length;r++){var l=o.currentPoints.canvas,u=a.data[r];!0===(0,g.default)(o.element,u.handles,l)&&(n=!0),(e.pointNearTool(o.element,u,l)&&!u.active||!e.pointNearTool(o.element,u,l)&&u.active)&&(u.active=!u.active,n=!0)}!0===n&&i.updateImage(o.element)}}}function n(t,o){function n(){l.invalidated=!0,(0,b.default)(o,l.handles)&&(0,P.removeToolState)(u,e.toolType,l),i.updateImage(u),(0,r.default)(u).on("CornerstoneToolsMouseMove",o,e.mouseMoveCallback||a)}var l=void 0,u=o.element;if((0,x.default)(o.which,t.data.mouseButtonMask)){var s=o.startPoints.canvas,d=(0,P.getToolState)(t.currentTarget,e.toolType);if(d){var c=void 0,g=void 0;for(g=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,c=0;c<d.data.length;c++){l=d.data[c];var v=(0,f.default)(u,l.handles,s,6);if(v)return(0,r.default)(u).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),l.active=!0,(0,m.default)(o,e.toolType,l,v,n,g),t.stopImmediatePropagation(),!1}if(e.pointNearTool){var h=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(c=0;c<d.data.length;c++)if(l=d.data[c],l.active=!1,e.pointNearTool(u,l,s))return l.active=!0,(0,r.default)(u).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,y.default)(t,l,d,e.toolType,h,n),t.stopImmediatePropagation(),!1}}}}function l(t){(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,r.default)(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&(0,r.default)(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),i.updateImage(t)}function u(t){(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,r.default)(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&(0,r.default)(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),(0,r.default)(t).on("CornerstoneImageRendered",e.onImageRendered),i.updateImage(t)}function d(t,l){var u={mouseButtonMask:l};(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,r.default)(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),(0,r.default)(t).on("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).on("CornerstoneToolsMouseMove",u,e.mouseMoveCallback||a),(0,r.default)(t).on("CornerstoneToolsMouseDown",u,e.mouseDownCallback||n),(0,r.default)(t).on("CornerstoneToolsMouseDownActivate",u,e.mouseDownActivateCallback||o),e.mouseDoubleClickCallback&&((0,r.default)(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),(0,r.default)(t).on("CornerstoneToolsMouseDoubleClick",u,e.mouseDoubleClickCallback)),i.updateImage(t)}function c(t,l){var u={mouseButtonMask:l},s="CornerstoneToolsToolDeactivated",d={mouseButtonMask:l,toolType:e.toolType,type:s},f=r.default.Event(s,d);(0,r.default)(t).trigger(f,d),(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",e.mouseMoveCallback||a),(0,r.default)(t).off("CornerstoneToolsMouseDown",e.mouseDownCallback||n),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",e.mouseDownActivateCallback||o),(0,r.default)(t).on("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).on("CornerstoneToolsMouseMove",u,e.mouseMoveCallback||a),(0,r.default)(t).on("CornerstoneToolsMouseDown",u,e.mouseDownCallback||n),e.mouseDoubleClickCallback&&((0,r.default)(t).off("CornerstoneToolsMouseDoubleClick",e.mouseDoubleClickCallback),(0,r.default)(t).on("CornerstoneToolsMouseDoubleClick",u,e.mouseDoubleClickCallback)),i.updateImage(t)}function v(){return T}function h(e){T=e}var T={},C={enable:u,disable:l,activate:d,deactivate:c,getConfiguration:v,setConfiguration:h,mouseDownCallback:n,mouseMoveCallback:a,mouseDownActivateCallback:o};return e.pointNearTool&&(C.pointNearTool=e.pointNearTool),e.mouseDoubleClickCallback&&(C.mouseDoubleClickCallback=e.mouseDoubleClickCallback),e.addNewMeasurement&&(C.addNewMeasurement=e.addNewMeasurement),C};var n=o(1),r=a(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(30),s=a(u),d=o(16),f=a(d),c=o(27),g=a(c),v=o(22),m=a(v),h=o(23),p=a(h),T=o(28),y=a(T),C=o(13),b=a(C),M=o(4),x=a(M),P=o(2)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r){e.strokeStyle=a,Object.keys(o).forEach(function(a){var u=o[a];if(!0!==u.drawnIndependently&&(!r||!0!==r.drawHandlesIfActive||u.active)){e.beginPath(),u.active?e.lineWidth=l.default.getActiveWidth():e.lineWidth=l.default.getToolWidth();var s=n.pixelToCanvas(t.element,u);e.arc(s.x,s.y,i,0,2*Math.PI),r&&r.fill&&(e.fillStyle=r.fill,e.fill()),e.stroke()}})};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),r=o(6),l=function(e){return e&&e.__esModule?e:{default:e}}(r),i=6},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function r(e){if(e)for(var t=0;t<e.data.length;t++){var o=e.data[t];o.active=!1,o.handles&&n(o.handles)}}function l(e){function t(t){var r=t.element,l=e.createNewMeasurement(t);if(l){if((0,b.addToolState)(r,e.toolType,l),1===Object.keys(l.handles).length&&"CornerstoneToolsTap"===t.type)return l.active=!1,l.handles.end.active=!1,l.handles.end.highlight=!1,l.invalidated=!0,(0,c.default)(t,l.handles)&&(0,b.removeToolState)(r,e.toolType,l),void d.updateImage(r);(0,u.default)(r).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(r).off("CornerstoneToolsTap",e.tapCallback||a),(0,u.default)(r).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),d.updateImage(r),(0,T.default)(t,e.toolType,l,l.handles.end,function(){l.active=!1,l.invalidated=!0,(0,c.default)(t,l.handles)&&(0,b.removeToolState)(r,e.toolType,l),(0,u.default)(r).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(r).on("CornerstoneToolsTap",e.tapCallback||a),(0,u.default)(r).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),d.updateImage(r)})}}function o(o,a){return e.addNewMeasurement?e.addNewMeasurement(a):t(a),!1}function a(t,l){function i(){r(g),(0,c.default)(l,m.handles)&&(0,b.removeToolState)(s,e.toolType,m),d.updateImage(s),(0,u.default)(s).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(s).on("CornerstoneToolsTap",e.tapCallback||a)}var s=l.element,f=l.currentPoints.canvas,g=(0,b.getToolState)(t.currentTarget,e.toolType),m=void 0,p=void 0;if(r(g),g)for(p=0;p<g.data.length;p++){m=g.data[p];var T=(0,v.default)(s,m.handles,f,25);if(T)return(0,u.default)(s).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(s).off("CornerstoneToolsTap",e.tapCallback||a),m.active=!0,T.active=!0,d.updateImage(s),(0,h.default)(t,e.toolType,m,T,i),t.stopImmediatePropagation(),!1}if(g&&e.pointNearTool)for(p=0;p<g.data.length;p++)if(m=g.data[p],e.pointNearTool(s,m,f))return(0,u.default)(s).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(s).off("CornerstoneToolsTap",e.tapCallback||a),m.active=!0,d.updateImage(s),(0,C.default)(t,m,g,e.toolType,!0,i),t.stopImmediatePropagation(),!1;return e.touchDownActivateCallback?e.touchDownActivateCallback(t,l):o(t,l),!1}function n(t,o){function r(t,r){if(s.active=!1,s.invalidated=!0,(0,c.default)(o,s.handles)&&(0,b.removeToolState)(o.element,e.toolType,s),d.updateImage(o.element),(0,u.default)(l).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(l).on("CornerstoneToolsTap",e.tapCallback||a),e.pressCallback&&(0,u.default)(l).on("CornerstoneToolsTouchPress",e.pressCallback),t&&"CornerstoneToolsTouchPress"===t.type){var i=u.default.Event(t.type,r);(0,u.default)(l).trigger(i,r)}}var l=o.element,i=o.startPoints.canvas,s=void 0,f=(0,b.getToolState)(t.currentTarget,e.toolType),g=void 0;if(f){for(g=0;g<f.data.length;g++){s=f.data[g];var m=(0,v.default)(o.element,s.handles,i,28);if(m)return(0,u.default)(l).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(l).off("CornerstoneToolsTap",e.tapCallback||a),e.pressCallback&&(0,u.default)(l).off("CornerstoneToolsTouchPress",e.pressCallback),s.active=!0,(0,h.default)(t,e.toolType,s,m,r),t.stopImmediatePropagation(),!1}if(e.pointNearTool)for(g=0;g<f.data.length;g++)if(s=f.data[g],e.pointNearTool(o.element,s,i))return(0,u.default)(l).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(l).off("CornerstoneToolsTap",e.tapCallback||a),e.pressCallback&&(0,u.default)(l).off("CornerstoneToolsTouchPress",e.pressCallback),(0,C.default)(t,s,f,e.toolType,!0,r),t.stopImmediatePropagation(),!1}}function l(t){(0,u.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,u.default)(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(t).off("CornerstoneToolsTap",e.tapCallback||a),e.doubleTapCallback&&(0,u.default)(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&(0,u.default)(t).off("CornerstoneToolsTouchPress",e.pressCallback),d.updateImage(t)}function i(t){(0,u.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,u.default)(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(t).off("CornerstoneToolsTap",e.tapCallback||a),(0,u.default)(t).on("CornerstoneImageRendered",e.onImageRendered),e.doubleTapCallback&&(0,u.default)(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&(0,u.default)(t).off("CornerstoneToolsTouchPress",e.pressCallback),d.updateImage(t)}function s(t){(0,u.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,u.default)(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(t).off("CornerstoneToolsTap",e.tapCallback||a),(0,u.default)(t).on("CornerstoneImageRendered",e.onImageRendered),(0,u.default)(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(t).on("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(t).on("CornerstoneToolsTap",e.tapCallback||a),e.doubleTapCallback&&((0,u.default)(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),(0,u.default)(t).on("CornerstoneToolsDoubleTap",e.doubleTapCallback)),e.pressCallback&&((0,u.default)(t).off("CornerstoneToolsTouchPress",e.pressCallback),(0,u.default)(t).on("CornerstoneToolsTouchPress",e.pressCallback)),d.updateImage(t)}function f(t){var r="CornerstoneToolsToolDeactivated",l={toolType:e.toolType,type:r},i=u.default.Event(r,l);(0,u.default)(t).trigger(i,l),(0,u.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,u.default)(t).off("CornerstoneToolsTouchStart",e.touchStartCallback||n),(0,u.default)(t).off("CornerstoneToolsTouchStartActive",e.touchDownActivateCallback||o),(0,u.default)(t).off("CornerstoneToolsTap",e.tapCallback||a),(0,u.default)(t).on("CornerstoneImageRendered",e.onImageRendered),(0,u.default)(t).on("CornerstoneToolsTouchStart",e.touchStartCallback||n),e.doubleTapCallback&&(0,u.default)(t).off("CornerstoneToolsDoubleTap",e.doubleTapCallback),e.pressCallback&&(0,u.default)(t).off("CornerstoneToolsTouchPress",e.pressCallback),d.updateImage(t)}var g={enable:i,disable:l,activate:s,deactivate:f,touchStartCallback:e.touchStartCallback||n,touchDownActivateCallback:e.touchDownActivateCallback||o,tapCallback:e.tapCallback||a};return e.pointNearTool&&(g.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(g.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(g.pressCallback=e.pressCallback),e.addNewMeasurement&&(g.addNewMeasurement=e.addNewMeasurement),g}Object.defineProperty(t,"__esModule",{value:!0});var i=o(1),u=a(i),s=o(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(s),f=o(13),c=a(f),g=o(16),v=a(g),m=o(45),h=a(m),p=o(24),T=a(p),y=o(44),C=a(y),b=o(2);t.default=l},function(e,t,o){"use strict";function a(e){s=e}function n(){return s}function r(e){d=e}function l(){return d}function i(e){f=e}function u(){return f}Object.defineProperty(t,"__esModule",{value:!0});var s=void 0,d=void 0,f=void 0,c={setStartLoadHandler:a,getStartLoadHandler:n,setEndLoadHandler:r,getEndLoadHandler:l,setErrorLoadingHandler:i,getErrorLoadingHandler:u};t.default=c},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o="CornerstoneToolsTouchDrag";return t&&!0===t.fireOnTouchStart&&(o+=" CornerstoneToolsTouchStart"),{activate:function(a){(0,n.default)(a).off(o,e),t&&t.eventData?(0,n.default)(a).on(o,t.eventData,e):(0,n.default)(a).on(o,e),t&&t.activateCallback&&t.activateCallback(a)},disable:function(a){(0,n.default)(a).off(o,e),t&&t.disableCallback&&t.disableCallback(a)},enable:function(a){(0,n.default)(a).off(o,e),t&&t.enableCallback&&t.enableCallback(a)},deactivate:function(a){(0,n.default)(a).off(o,e),t&&t.deactivateCallback&&t.deactivateCallback(a)}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=e.image,a={left:0,top:0,width:o.width,height:o.height},r=!1;return Object.keys(t).forEach(function(e){var o=t[e];!0!==o.allowedOutsideImage&&!1===n.point.insideRect(o,a)&&(r=!0)}),r};var a=o(3),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t,o,a){(0,n.default)(t).off("CornerstoneToolsMouseDownActivate",e);var r={mouseButtonMask:o,options:a};(0,n.default)(t).on("CornerstoneToolsMouseDownActivate",r,e)},disable:function(t){(0,n.default)(t).off("CornerstoneToolsMouseDownActivate",e)},enable:function(t){(0,n.default)(t).off("CornerstoneToolsMouseDownActivate",e)},deactivate:function(t){(0,n.default)(t).off("CornerstoneToolsMouseDownActivate",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){d=e}function n(){return d}function r(e){s=e}function l(){return s}function i(e){f=e}function u(){return f}Object.defineProperty(t,"__esModule",{value:!0});var s=15,d=s+"px Arial",f="transparent",c={setFont:a,getFont:n,setFontSize:r,getFontSize:l,setBackgroundColor:i,getBackgroundColor:u};t.default=c},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){var n=void 0;if(t)return Object.keys(t).forEach(function(l){var u=t[l];if(u.hasOwnProperty("pointNearHandle")){if(u.pointNearHandle(e,u,o))return void(n=u)}else if(!0===u.hasBoundingBox){if((0,s.default)(u,o))return void(n=u)}else{var d=r.pixelToCanvas(e,u),f=i.point.distance(d,o);if(f<=a)return void(n=u)}}),n};var n=o(0),r=a(n),l=o(3),i=a(l),u=o(19),s=function(e){return e&&e.__esModule?e:{default:e}}(u)},function(e,t,o){"use strict";function a(){function e(e){return u[e]}function t(e,t){u[e]=t}function o(){return u}function a(e){u=e}function n(e,t,o){var a=r.getEnabledElement(e);a.image&&!1!==u.hasOwnProperty(a.image.imageId)||(u[a.image.imageId]={});var n=u[a.image.imageId];!1===n.hasOwnProperty(t)&&(n[t]={data:[]}),n[t].data.push(o)}function l(e,t){var o=r.getEnabledElement(e);if(o.image&&!1!==u.hasOwnProperty(o.image.imageId)){var a=u[o.image.imageId];if(!1!==a.hasOwnProperty(t)){return a[t]}}}function i(e){var t=r.getEnabledElement(e);t.image&&!1!==u.hasOwnProperty(t.image.imageId)&&delete u[t.image.imageId]}var u={};return{get:l,add:n,clear:i,saveImageIdToolState:e,restoreImageIdToolState:t,saveToolState:o,restoreToolState:a,toolState:u}}Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var n=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),l=a();t.newImageIdSpecificToolStateManager=a,t.globalImageIdSpecificToolStateManager=l},function(e,t,o){"use strict";function a(e){return parseFloat("."+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=r.metaData.get("patientStudyModule",e.imageId),n=r.metaData.get("generalSeriesModule",e.imageId);if(o&&n){if("PT"===n.modality){var l=t*e.slope+e.intercept,i=o.patientWeight;if(i){var u=r.metaData.get("petIsotopeModule",e.imageId);if(u){var s=u.radiopharmaceuticalInfo,d=s.radiopharmaceuticalStartTime,f=s.radionuclideTotalDose,c=s.radionuclideHalfLife,g=n.seriesTime;if(d&&f&&c&&g){var v=a(g.fractionalSeconds||0)+g.seconds+60*g.minutes+60*g.hours*60,m=a(d.fractionalSeconds)+d.seconds+60*d.minutes+60*d.hours*60,h=v-m;return l*i/(f*Math.exp(-h*Math.log(2)/c))*1e3}}}}}};var n=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return n.point.insideRect(t,e.boundingBox)};var a=o(3),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{disable:function(t){(0,n.default)(t).off("CornerstoneImageRendered",e)},enable:function(t){(0,n.default)(t).off("CornerstoneImageRendered",e),(0,n.default)(t).on("CornerstoneImageRendered",e),l.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){(0,n.default)(t).off("CornerstoneToolsMouseWheel",e);var o={};(0,n.default)(t).on("CornerstoneToolsMouseWheel",o,e)},disable:function(t){(0,n.default)(t).off("CornerstoneToolsMouseWheel",e)},enable:function(t){(0,n.default)(t).off("CornerstoneToolsMouseWheel",e)},deactivate:function(t){(0,n.default)(t).off("CornerstoneToolsMouseWheel",e)}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r,i){function u(e,r){!1===a.hasMoved&&(a.hasMoved=!0),a.active=!0,a.x=r.currentPoints.image.x+f.x,a.y=r.currentPoints.image.y+f.y,i&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,r.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,r.image.height)),l.updateImage(d);var u={toolType:t,element:d,measurementData:o};(0,n.default)(d).trigger("CornerstoneToolsMeasurementModified",u)}function s(){a.active=!1,(0,n.default)(d).off("CornerstoneToolsMouseDrag",u),(0,n.default)(d).off("CornerstoneToolsMouseUp",s),(0,n.default)(d).off("CornerstoneToolsMouseClick",s),l.updateImage(d),"function"==typeof r&&r()}var d=e.element,f={x:a.x-e.currentPoints.image.x,y:a.y-e.currentPoints.image.y};(0,n.default)(d).on("CornerstoneToolsMouseDrag",u),(0,n.default)(d).on("CornerstoneToolsMouseUp",s),(0,n.default)(d).on("CornerstoneToolsMouseClick",s)};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r,i){function u(e,r){a.active=!0,a.x=r.currentPoints.image.x,a.y=r.currentPoints.image.y,i&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,r.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,r.image.height)),l.updateImage(g);var u={toolType:t,element:g,measurementData:o};(0,n.default)(g).trigger("CornerstoneToolsMeasurementModified",u)}function s(e){(0,n.default)(g).off("CornerstoneToolsMouseMove",s),(0,n.default)(g).off("CornerstoneToolsMouseDrag",s),(0,n.default)(g).on("CornerstoneToolsMouseMove",u),(0,n.default)(g).on("CornerstoneToolsMouseDrag",u),(0,n.default)(g).on("CornerstoneToolsMouseClick",c),"CornerstoneToolsMouseDrag"===e.type&&(0,n.default)(g).on("CornerstoneToolsMouseUp",c)}function d(e,t){t.measurementData===o&&c()}function f(e,o){o.toolType===t&&((0,n.default)(g).off("CornerstoneToolsMouseMove",u),(0,n.default)(g).off("CornerstoneToolsMouseDrag",u),(0,n.default)(g).off("CornerstoneToolsMouseClick",c),(0,n.default)(g).off("CornerstoneToolsMouseUp",c),(0,n.default)(g).off("CornerstoneToolsMeasurementRemoved",d),(0,n.default)(g).off("CornerstoneToolsToolDeactivated",f),a.active=!1,l.updateImage(g))}function c(){(0,n.default)(g).off("CornerstoneToolsMouseMove",u),(0,n.default)(g).off("CornerstoneToolsMouseDrag",u),(0,n.default)(g).off("CornerstoneToolsMouseClick",c),(0,n.default)(g).off("CornerstoneToolsMouseUp",c),(0,n.default)(g).off("CornerstoneToolsMeasurementRemoved",d),(0,n.default)(g).off("CornerstoneToolsToolDeactivated",f),a.active=!1,l.updateImage(g),"function"==typeof r&&r()}var g=e.element;(0,n.default)(g).on("CornerstoneToolsMouseDrag",s),(0,n.default)(g).on("CornerstoneToolsMouseMove",s),(0,n.default)(g).on("CornerstoneToolsMeasurementRemoved",d),(0,n.default)(g).on("CornerstoneToolsToolDeactivated",f)};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r,i){function u(e,r){a.x=r.currentPoints.image.x+v.x,a.y=r.currentPoints.image.y+v.y,i&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,r.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,r.image.height)),l.updateImage(c);var u={toolType:t,element:c,measurementData:o};(0,n.default)(c).trigger("CornerstoneToolsMeasurementModified",u)}function s(e,t){if((0,n.default)(c).off("CornerstoneToolsTouchDrag",u),(0,n.default)(c).off("CornerstoneToolsTouchPinch",s),(0,n.default)(c).off("CornerstoneToolsTouchEnd",s),(0,n.default)(c).off("CornerstoneToolsTap",s),(0,n.default)(c).off("CornerstoneToolsTouchStart",d),(0,n.default)(c).off("CornerstoneToolsToolDeactivated",f),"CornerstoneToolsTouchPinch"===e.type||"CornerstoneToolsTouchPress"===e.type)return a.active=!1,l.updateImage(c),void r();a.active=!1,o.active=!1,a.x=t.currentPoints.image.x+v.x,a.y=t.currentPoints.image.y+v.y,i&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,t.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,t.image.height)),l.updateImage(c),"function"==typeof r&&r()}function d(e){return e.stopImmediatePropagation(),!1}function f(){(0,n.default)(c).off("CornerstoneToolsTouchDrag",u),(0,n.default)(c).off("CornerstoneToolsTouchPinch",s),(0,n.default)(c).off("CornerstoneToolsTouchEnd",s),(0,n.default)(c).off("CornerstoneToolsTap",s),(0,n.default)(c).off("CornerstoneToolsTouchStart",d),(0,n.default)(c).off("CornerstoneToolsToolDeactivated",f),a.active=!1,o.active=!1,a.x=e.currentPoints.image.x+v.x,a.y=e.currentPoints.image.y+v.y,i&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,e.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,e.image.height)),l.updateImage(c)}var c=e.element,g=l.pageToPixel(c,e.currentPoints.page.x,e.currentPoints.page.y+50),v={x:a.x-g.x,y:a.y-g.y};a.active=!0,o.active=!0,(0,n.default)(c).on("CornerstoneToolsTouchDrag",u),(0,n.default)(c).on("CornerstoneToolsTouchPinch",s),(0,n.default)(c).on("CornerstoneToolsTouchEnd",s),(0,n.default)(c).on("CornerstoneToolsTap",s),(0,n.default)(c).on("CornerstoneToolsTouchStart",d),(0,n.default)(c).on("CornerstoneToolsToolDeactivated",f)};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r)},function(e,t,o){"use strict";function a(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],o=void 0;return/trident/i.test(t[1])?(o=/\brv[ :]+(\d+)/g.exec(e)||[],"IE "+(o[1]||"")):"Chrome"===t[1]&&null!==(o=e.match(/\b(OPR|Edge)\/(\d+)/))?o.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(o=e.match(/version\/(\d+)/i))&&t.splice(1,1,o[1]),t.join(" "))}function n(e){u=e}function r(){return u||l()}function l(){var e=a(),t=e.split(" "),o=t[0],n=t[1],r=s[o];return r?r[n]?r[n]:r.default:s.default}function i(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}Object.defineProperty(t,"__esModule",{value:!0});var u=void 0,s={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};t.getDefaultSimultaneousRequests=l,t.getMaxSimultaneousRequests=r,t.setMaxSimultaneousRequests=n,t.getBrowserInfo=a,t.isMobileDevice=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o={},a="CornerstoneToolsMultiTouchDrag";return t&&!0===t.fireOnTouchStart&&(a+=" CornerstoneToolsMultiTouchStart"),{activate:function(o){(0,n.default)(o).off(a,e),t&&t.eventData?(0,n.default)(o).on(a,t.eventData,e):(0,n.default)(o).on(a,e),t&&t.activateCallback&&t.activateCallback(o)},disable:function(o){(0,n.default)(o).off(a,e),t&&t.disableCallback&&t.disableCallback(o)},enable:function(o){(0,n.default)(o).off(a,e),t&&t.enableCallback&&t.enableCallback(o)},deactivate:function(o){(0,n.default)(o).off(a,e),t&&t.deactivateCallback&&t.deactivateCallback(o)},getConfiguration:function(){return o},setConfiguration:function(e){o=e}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){var t=void 0;return Object.keys(e).forEach(function(o){var a=e[o];if(!0===a.active)return void(t=a)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n){n||(n=6);var l=a(t),i=(0,r.default)(e,t,o,n);return l!==i&&(void 0!==i&&(i.active=!0),void 0!==l&&(l.active=!1),!0)};var n=o(16),r=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function u(e,o){t.active=!0,Object.keys(t.handles).forEach(function(e){var a=t.handles[e];!0!==a.movesIndependently&&(a.x+=o.deltaPoints.image.x,a.y+=o.deltaPoints.image.y,!0===n.preventHandleOutsideImage&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,o.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,o.image.height)))}),i.updateImage(c);var l={toolType:a,element:c,measurementData:t};return(0,r.default)(c).trigger("CornerstoneToolsMeasurementModified",l),!1}function f(e,o){t.invalidated=!0,(0,r.default)(c).off("CornerstoneToolsMouseDrag",u),(0,r.default)(c).off("CornerstoneToolsMouseUp",f),(0,r.default)(c).off("CornerstoneToolsMouseClick",f),!0===n.deleteIfHandleOutsideImage&&(0,s.default)(o,t.handles)&&(0,d.removeToolState)(c,a,t),i.updateImage(c),"function"==typeof l&&l()}var c=e.element;return(0,r.default)(c).on("CornerstoneToolsMouseDrag",u),(0,r.default)(c).on("CornerstoneToolsMouseUp",f),(0,r.default)(c).on("CornerstoneToolsMouseClick",f),!0};var n=o(1),r=a(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(13),s=a(u),d=o(2)},function(e,t,o){"use strict";function a(e,t,o,a,n,r){if(!g.hasOwnProperty(o))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var l={type:o,imageId:t,preventCache:a,doneCallback:n,failCallback:r},i=f.imageCache.getImagePromise(t);if(i)return void i.then(function(e){n(e)},function(e){r(e)});g[o].push(l)}}function n(e){if(!g.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");g[e]=[]}function r(){h&&setTimeout(function(){i()},p)}function l(e){var t=e.type;v[t]++,h=!0;var o=e.imageId,a=e.doneCallback,n=e.failCallback,l=f.imageCache.getImagePromise(o);if(l)return void l.then(function(e){v[t]--,a(e),r()},function(e){v[t]--,n(e),r()});var i=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),u=void 0;u=!0===e.preventCache?f.loadImage(o,{priority:i,type:e.type}):f.loadAndCacheImage(o,{priority:i,type:e.type}),u.then(function(e){v[t]--,a(e),r()},function(e){v[t]--,n(e),r()})}function i(){var e=(0,c.getMaxSimultaneousRequests)();m={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=v.interaction+v.thumbnail+v.prefetch,o=e-t,a=0;a<o;a++){var n=u();n&&l(n)}}function u(){return g.interaction.length&&v.interaction<m.interaction?g.interaction.shift():g.thumbnail.length&&v.thumbnail<m.thumbnail?g.thumbnail.shift():g.prefetch.length&&v.prefetch<m.prefetch?g.prefetch.shift():(g.interaction.length||g.thumbnail.length||g.prefetch.length||(h=!1),!1)}function s(){return g}Object.defineProperty(t,"__esModule",{value:!0});var d=o(0),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(d),c=o(25),g={interaction:[],thumbnail:[],prefetch:[]},v={interaction:0,thumbnail:0,prefetch:0},m={interaction:6,thumbnail:6,prefetch:5},h=!1,p=20;t.default={addRequest:a,clearRequestStack:n,startGrabbing:i,getRequestPool:s}},function(e,t,o){"use strict";function a(e){r=e.currentPoints.canvas}function n(){return r}Object.defineProperty(t,"__esModule",{value:!0});var r=void 0,l={setCoords:a,getCoords:n};t.default=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var a=(0,r.getToolState)(e,"timeSeries");if(a&&a.data&&a.data.length){var l=a.data[0],u=l.stacks[l.currentStackIndex],s=u.currentImageIdIndex,d=l.currentStackIndex+t;if(o?(d>=l.stacks.length&&(d=0),d<0&&(d=l.stacks.length-1)):(d=Math.min(l.stacks.length-1,d),d=Math.max(0,d)),d!==l.currentStackIndex){var f=n.getViewport(e),c=l.stacks[d],g=i.default.getStartLoadHandler(),v=i.default.getEndLoadHandler(),m=i.default.getErrorLoadingHandler();g&&g(e);var h=void 0;h=!0===c.preventCache?n.loadImage(c.imageIds[s]):n.loadAndCacheImage(c.imageIds[s]),h.then(function(t){l.currentImageIdIndex!==s&&(c.currentImageIdIndex=s,l.currentStackIndex=d,n.displayImage(e,t,f),v&&v(e,t))},function(t){var o=c.imageIds[s];m&&m(e,o,t)})}}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),r=o(2),l=o(11),i=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:n.point.copy(e.page),image:n.point.copy(e.image),client:n.point.copy(e.client),canvas:n.point.copy(e.canvas)}};var a=o(3),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),o=Math.round(o);var l=n.getEnabledElement(e),i=[],u=0,s=l.image.getPixelData(),d=void 0,f=void 0,c=void 0;if(l.image.color)for(f=0;f<r;f++)for(c=0;c<a;c++){d=4*((f+o)*l.image.columns+(c+t));var g=s[d],v=s[d+1],m=s[d+2],h=s[d+3];i[u++]=g,i[u++]=v,i[u++]=m,i[u++]=h}return i};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=e.width/2,a=e.height/2;if(o<=0||a<=0)return!1;var n={x:e.left+o,y:e.top+a},r={x:t.x-n.x,y:t.y-n.y};return r.x*r.x/(o*o)+r.y*r.y/(a*a)<=1}},function(e,t,o){"use strict";function a(e,t){var o=e.clone().sub(t.imagePositionPatient);return{x:t.rowCosines.dot(o)/t.columnPixelSpacing,y:t.columnCosines.dot(o)/t.rowPixelSpacing}}function n(e,t){var o=t.rowCosines.clone().multiplyScalar(e.x);o.multiplyScalar(t.columnPixelSpacing);var a=t.columnCosines.clone().multiplyScalar(e.y);a.multiplyScalar(t.rowPixelSpacing);var n=o.add(a);return n.add(t.imagePositionPatient),n}function r(e){var t=n({x:0,y:0},e),o=n({x:e.columns,y:0},e),a=n({x:0,y:e.rows},e),r=n({x:e.columns,y:e.rows},e);return{top:new s.Line3(t,o),left:new s.Line3(t,a),right:new s.Line3(o,r),bottom:new s.Line3(a,r)}}function l(e,t){var o=[];return Object.keys(t).forEach(function(a){var n=t[a],r=e.intersectLine(n);r&&o.push(r)}),o}function i(e,t){var o=e.rowCosines.clone().cross(e.columnCosines),a=new s.Plane;a.setFromNormalAndCoplanarPoint(o,e.imagePositionPatient);var i=t.rowCosines.clone().cross(t.columnCosines),u=new s.Plane;u.setFromNormalAndCoplanarPoint(i,t.imagePositionPatient);var d=u.clone().intersectPlane(a),f=d.origin,c=d.direction,g=n({x:t.columns,y:t.rows},t),v=t.imagePositionPatient.distanceTo(g),m=new s.Line3;m.start=f,m.end=f.clone().add(c.multiplyScalar(v));var h=r(t),p=l(m,h);if(2===p.length)return{start:p[0],end:p[1]}}Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=a,t.imagePointToPatientPoint=n,t.planePlaneIntersection=i;var u=o(3),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(u)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=Math.pow(10,t);return Math.round(e*o)/o}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=(0,r.getToolState)(e,"stack");if(a&&a.data&&a.data.length){var l=a.data[0],i=l.currentImageIdIndex+t;if(o){i%=l.imageIds.length}else i=Math.min(l.imageIds.length-1,i),i=Math.max(0,i);(0,n.default)(e,i)}};var a=o(53),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r=o(2)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){(0,n.default)(t).off("CornerstoneToolsDoubleTap",e);var o={};(0,n.default)(t).on("CornerstoneToolsDoubleTap",o,e)},disable:function(t){(0,n.default)(t).off("CornerstoneToolsDoubleTap",e)},enable:function(t){(0,n.default)(t).off("CornerstoneToolsDoubleTap",e)},deactivate:function(t){(0,n.default)(t).off("CornerstoneToolsDoubleTap",e)}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){(0,n.default)(t).off("CornerstoneToolsKeyDown",e),(0,n.default)(t).on("CornerstoneToolsKeyDown",e)},disable:function(t){(0,n.default)(t).off("CornerstoneToolsKeyDown",e)},enable:function(t){(0,n.default)(t).off("CornerstoneToolsKeyDown",e)},deactivate:function(t){(0,n.default)(t).off("CornerstoneToolsKeyDown",e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){var a=e.createNewMeasurement(o);a&&((0,M.addToolState)(o.element,e.toolType,a),(0,r.default)(o.element).off("CornerstoneToolsMouseMove",n),(0,m.default)(o,e.toolType,a,a.handles.end,function(){a.active=!1,(0,y.default)(o,a.handles)&&(0,M.removeToolState)(o.element,e.toolType,a),(0,r.default)(o.element).on("CornerstoneToolsMouseMove",n)},t))}function a(e,t){if((0,b.default)(t.which,e.data.mouseButtonMask))return o(t),!1}function n(t,o){if(s.default.setCoords(o),0===o.which){var a=(0,M.getToolState)(o.element,e.toolType);if(void 0!==a){for(var n=!1,r=o.currentPoints.canvas,l=0;l<a.data.length;l++){var u=a.data[l];!0===(0,g.default)(o.element,u.handles,r)&&(n=!0),(e.pointInsideRect(o.element,u,r)&&!u.active||!e.pointInsideRect(o.element,u,r)&&u.active)&&(u.active=!u.active,n=!0)}!0===n&&i.updateImage(o.element)}}}function l(o,a){function l(){u.active=!1,(0,y.default)(a,u.handles)&&(0,M.removeToolState)(a.element,e.toolType,u),i.updateImage(a.element),(0,r.default)(a.element).on("CornerstoneToolsMouseMove",n)}var u=void 0;if((0,b.default)(a.which,o.data.mouseButtonMask)){var s=a.startPoints.canvas,d=(0,M.getToolState)(o.currentTarget,e.toolType),c=void 0;if(void 0!==d)for(c=0;c<d.data.length;c++){u=d.data[c];var g=(0,f.default)(a.element,u.handles,s,25);if(void 0!==g)return(0,r.default)(a.element).off("CornerstoneToolsMouseMove",n),u.active=!0,(0,m.default)(a,e.toolType,u,g,l,t),o.stopImmediatePropagation(),!1}var v={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==d&&void 0!==e.pointInsideRect)for(c=0;c<d.data.length;c++)if(u=d.data[c],e.pointInsideRect(a.element,u,s))return(0,r.default)(a.element).off("CornerstoneToolsMouseMove",n),(0,p.default)(o,u,d,e.toolType,v,l),(0,r.default)(a.element).on("CornerstoneToolsMouseMove",n),o.stopImmediatePropagation(),!1}}function u(t){(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",n),(0,r.default)(t).off("CornerstoneToolsMouseDown",l),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",a),i.updateImage(t)}function d(t){(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",n),(0,r.default)(t).off("CornerstoneToolsMouseDown",l),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",a),(0,r.default)(t).on("CornerstoneImageRendered",e.onImageRendered),i.updateImage(t)}function c(t,o){var u={mouseButtonMask:o};(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",n),(0,r.default)(t).off("CornerstoneToolsMouseDown",l),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",a),(0,r.default)(t).on("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).on("CornerstoneToolsMouseMove",u,n),(0,r.default)(t).on("CornerstoneToolsMouseDown",u,l),(0,r.default)(t).on("CornerstoneToolsMouseDownActivate",u,a),i.updateImage(t)}function v(t,o){var u={mouseButtonMask:o};(0,r.default)(t).off("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).off("CornerstoneToolsMouseMove",n),(0,r.default)(t).off("CornerstoneToolsMouseDown",l),(0,r.default)(t).off("CornerstoneToolsMouseDownActivate",a),(0,r.default)(t).on("CornerstoneImageRendered",e.onImageRendered),(0,r.default)(t).on("CornerstoneToolsMouseMove",u,n),(0,r.default)(t).on("CornerstoneToolsMouseDown",u,l),i.updateImage(t)}return{enable:d,disable:u,activate:c,deactivate:v}};var n=o(1),r=a(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(30),s=a(u),d=o(16),f=a(d),c=o(27),g=a(c),v=o(22),m=a(v),h=o(28),p=a(h),T=o(13),y=a(T),C=o(4),b=a(C),M=o(2)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){(0,n.default)(t).off("CornerstoneToolsTouchPinch",e);var o={};(0,n.default)(t).on("CornerstoneToolsTouchPinch",o,e)},disable:function(t){(0,n.default)(t).off("CornerstoneToolsTouchPinch",e)},enable:function(t){(0,n.default)(t).off("CornerstoneToolsTouchPinch",e)},deactivate:function(t){(0,n.default)(t).off("CornerstoneToolsTouchPinch",e)}}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e,t){var o=Date.now();if(e!==c){if(o-g<=d)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;c=e}g=o}function n(e,t,o){var a=o?v:m;t.forEach(function(t){(0,s.default)(e).on(t,a)})}function r(e,t,o){var a=o?v:m;t.forEach(function(t){(0,s.default)(e).off(t,a)})}function l(e){r(e,h,f.mouse),r(e,p,f.touch)}function i(e){l(e),n(e,h,f.mouse),n(e,p,f.touch)}Object.defineProperty(t,"__esModule",{value:!0});var u=o(1),s=function(e){return e&&e.__esModule?e:{default:e}}(u),d=2e3,f={mouse:0,touch:1},c=void 0,g=void 0,v=a.bind(null,f.mouse),m=a.bind(null,f.touch),h=["mousedown","mouseup"],p=["touchstart","touchend"],T={enable:i,disable:l};t.default=T},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n,l){function u(e,o){t.active=!0,Object.keys(t.handles).forEach(function(e){var a=t.handles[e];!0!==a.movesIndependently&&(a.x+=o.deltaPoints.image.x,a.y+=o.deltaPoints.image.y)}),i.updateImage(c);var n={toolType:a,element:c,measurementData:t};return(0,r.default)(c).trigger("CornerstoneToolsMeasurementModified",n),!1}function f(e,o){t.active=!1,t.invalidated=!1,(0,r.default)(c).off("CornerstoneToolsTouchDrag",u),(0,r.default)(c).off("CornerstoneToolsTouchPinch",f),(0,r.default)(c).off("CornerstoneToolsTouchPress",f),(0,r.default)(c).off("CornerstoneToolsTouchEnd",f),(0,r.default)(c).off("CornerstoneToolsDragEnd",f),(0,r.default)(c).off("CornerstoneToolsTap",f),!0===n&&(0,s.default)(o,t.handles)&&(0,d.removeToolState)(c,a,t),i.updateImage(c),"function"==typeof l&&l(e,o)}var c=e.element;return(0,r.default)(c).on("CornerstoneToolsTouchDrag",u),(0,r.default)(c).on("CornerstoneToolsTouchPinch",f),(0,r.default)(c).on("CornerstoneToolsTouchPress",f),(0,r.default)(c).on("CornerstoneToolsTouchEnd",f),(0,r.default)(c).on("CornerstoneToolsDragEnd",f),(0,r.default)(c).on("CornerstoneToolsTap",f),!0};var n=o(1),r=a(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(13),s=a(u),d=o(2)},function(e,t,o){"use strict";function a(e,t,o,n,r){if(o.value){var l=(new Date).getTime(),u=Math.abs(t.y-r.y),s=u/10;if(console.log("distanceRemaining: "+u),u<1)return t.y=r.y,void(o.value=!1);t.y>r.y?t.y-=s:t.y<r.y&&(t.y+=s),i.updateImage(n.element),i.requestAnimationFrame(function(){a(l,t,o,n,r)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,n,l){function d(e,a){u.value=!1,!1===n.hasMoved&&(n.hasMoved=!0),n.active=!0;var l=a.currentPoints,s={x:l.page.x,y:l.page.y+m};p=i.pageToPixel(c,s.x,s.y),n.x=p.x,n.y=p.y,i.updateImage(c);var d={toolType:t,element:c,measurementData:o};(0,r.default)(c).trigger("CornerstoneToolsMeasurementModified",d)}function f(t,a){u.value=!1,n.active=!1,(0,r.default)(c).off("CornerstoneToolsTouchDrag",d),(0,r.default)(c).off(s,f),i.updateImage(c),"CornerstoneToolsTouchPress"===t.type&&(a.handlePressed=o,n.x=e.currentPoints.image.x,n.y=e.currentPoints.image.y),"function"==typeof l&&l(t,a)}u.value=!0;var c=e.element,g=i.getEnabledElement(c),v=(new Date).getTime(),m=-57,h={x:e.currentPoints.page.x,y:e.currentPoints.page.y+m},p=i.pageToPixel(c,h.x,h.y);(0,r.default)(c).on("CornerstoneToolsTouchDrag",d),(0,r.default)(c).on(s,f),a(v,n,u,g,p)};var n=o(1),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u={value:!1},s=["CornerstoneToolsTouchEnd","CornerstoneToolsDragEnd","CornerstoneToolsTouchPinch","CornerstoneToolsTouchPress","CornerstoneToolsTap"].join(" ")},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(114),r=a(n),l=o(115),i=a(l),u={getOrientationString:r.default,invertOrientationString:i.default};t.default=u},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){(0,d.default)(t.element).off("CornerstoneToolsMouseDrag",i),(0,d.default)(t.element).off("CornerstoneToolsMouseUp",n),(0,d.default)(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,C.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0};return(0,d.default)(t.element).on("CornerstoneToolsMouseDrag",o,i),(0,d.default)(t.element).on("CornerstoneToolsMouseUp",n),(0,d.default)(t.element).on("CornerstoneToolsMouseClick",n),e.stopImmediatePropagation(),!1}}function l(e,t){var o=-t.direction,a=P.getConfiguration(),n=!1;a&&a.loop&&(n=a.loop),(0,M.default)(t.element,o,n)}function i(e,t){var o=t.element,a=(0,x.getToolState)(o,"stack");if(a&&a.data&&a.data.length){var n=a.data[0],r=P.getConfiguration(),l=(0,d.default)(o).height()/Math.max(n.imageIds.length,8);if(r&&r.stackScrollSpeed&&(l=r.stackScrollSpeed),e.data.deltaY=e.data.deltaY||0,e.data.deltaY+=t.deltaPoints.page.y,Math.abs(e.data.deltaY)>=l){var i=e.data.deltaY/l,u=Math.round(i),s=e.data.deltaY%l;e.data.deltaY=s,(0,M.default)(o,u)}return!1}}function u(e,t){var o=k.getConfiguration();o&&o.testPointers(t)&&i(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var s=o(1),d=a(s),f=o(12),c=a(f),g=o(26),v=a(g),m=o(14),h=a(m),p=o(21),T=a(p),y=o(4),C=a(y),b=o(38),M=a(b),x=o(2),P=(0,h.default)(r),w=(0,T.default)(l),S={eventData:{deltaY:0}},I=(0,c.default)(i,S),O={testPointers:function(e){return e.numPointers>=3}},k=(0,v.default)(u,S);k.setConfiguration(O),t.stackScroll=P,t.stackScrollWheel=w,t.stackScrollTouchDrag=I,t.stackScrollMultiTouch=k},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var o=0,a=0,r=0,l=0,i=t.top;i<t.top+t.height;i++)for(var u=t.left;u<t.left+t.width;u++){var s={x:u,y:i};(0,n.default)(t,s)&&(o+=e[l],a+=e[l]*e[l],r++),l++}if(0===r)return{count:r,mean:0,variance:0,stdDev:0};var d=o/r,f=a/r-d*d;return{count:r,mean:d,variance:f,stdDev:Math.sqrt(f)}};var a=o(35),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n){var r=Math.atan2(o.y-t.y,o.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(o.x,o.y),e.strokeStyle=a,e.lineWidth=n,e.stroke(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(o.x-10*Math.cos(r-Math.PI/7),o.y-10*Math.sin(r-Math.PI/7)),e.lineTo(o.x-10*Math.cos(r+Math.PI/7),o.y-10*Math.sin(r+Math.PI/7)),e.lineTo(o.x,o.y),e.lineTo(o.x-10*Math.cos(r-Math.PI/7),o.y-10*Math.sin(r-Math.PI/7)),e.strokeStyle=a,e.lineWidth=n,e.stroke(),e.fillStyle=a,e.fill()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){e.beginPath(),e.strokeStyle=o,e.lineWidth=a,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,n){var r=a/2*.5522848,l=n/2*.5522848,i=t+a,u=o+n,s=t+a/2,d=o+n/2;e.beginPath(),e.moveTo(t,d),e.bezierCurveTo(t,d-l,s-r,o,s,o),e.bezierCurveTo(s+r,o,i,d-l,i,d),e.bezierCurveTo(i,d+l,s+r,u,s,u),e.bezierCurveTo(s-r,u,t,d+l,t,d),e.closePath(),e.stroke()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,r){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),o=Math.round(o);var l=n.getEnabledElement(e),i=l.image,u=[],s=0,d=i.getPixelData(),f=void 0,c=void 0,g=void 0;if(i.color)for(c=0;c<r;c++)for(g=0;g<a;g++){f=4*((c+o)*i.columns+(g+t));var v=d[f],m=d[f+1],h=d[f+2];u[s++]=.2126*v+.7152*m+.0722*h}else for(c=0;c<r;c++)for(g=0;g<a;g++)f=(c+o)*i.columns+(g+t),u[s++]=d[f]*i.slope+i.intercept;return u};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function o(o){if(f.currentImageIdIndex===t){try{i.getEnabledElement(e)}catch(e){return}l?(l.currentImageIdIndex=t,l.render(e,n.data)):i.displayImage(e,o,p),m&&m(e,o)}}function a(o){var a=f.imageIds[t];h&&h(e,a,o)}var n=(0,u.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var l=void 0;if(n.data.length>1){var s=(0,u.getToolState)(e,"stackRenderer");s&&s.data&&s.data.length&&(l=s.data[0])}var f=n.data[0];t<0&&(t+=f.imageIds.length);var v=c.default.getStartLoadHandler(),m=c.default.getEndLoadHandler(),h=c.default.getErrorLoadingHandler(),p=i.getViewport(e);if(t!==f.currentImageIdIndex){v&&v(e);var T={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var y=f.imageIds[t],C=g.stackScroll.getConfiguration();if(C&&!0===C.retryLoadOnScroll){var b=i.imageCache.getImagePromise(y);b&&"rejected"===b.state()&&i.imageCache.removeImagePromise(y)}var M=Boolean(f.preventCache),x=void 0;x=M?i.loadImage(y):i.loadAndCacheImage(y),x.then(o,a),d.default.startGrabbing(),(0,r.default)(e).trigger("CornerstoneStackScroll",T)}}};var n=o(1),r=a(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(2),s=o(29),d=a(s),f=o(11),c=a(f),g=o(47)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){return n.setToPixelCoordinateSystem(e,t,.1),{fontSize:o/e.viewport.scale/.1,lineHeight:o/e.viewport.scale/.1,fontScale:.1}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=(0,a.planePlaneIntersection)(e,t);if(o)return{start:(0,a.projectPatientPointToImagePlane)(o.start,e),end:(0,a.projectPatientPointToImagePlane)(o.end,e)}};var a=o(36)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){var n=r.getEnabledElement(o).image,l=r.getEnabledElement(a).image;if(n&&l){var u=r.metaData.get("imagePlane",n.imageId),d=r.metaData.get("imagePlane",l.imageId);if(u&&d&&u.rowCosines&&u.columnCosines&&u.imagePositionPatient&&d.rowCosines&&d.columnCosines&&d.imagePositionPatient&&u.frameOfReferenceUID===d.frameOfReferenceUID){var c=u.rowCosines.clone().cross(u.columnCosines),g=d.rowCosines.clone().cross(d.columnCosines),v=c.angleTo(g);if(!((v=Math.abs(v))<.5)){var m=(0,i.default)(u,d);if(m){var h=r.pixelToCanvas(t.element,m.start),p=r.pixelToCanvas(t.element,m.end),T=s.default.getActiveColor(),y=f.default.getToolWidth();e.setTransform(1,0,0,1,0,0),e.save(),e.beginPath(),e.strokeStyle=T,e.lineWidth=y,e.moveTo(h.x,h.y),e.lineTo(p.x,p.y),e.stroke(),e.restore()}}}}};var n=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),l=o(55),i=a(l),u=o(5),s=a(u),d=o(6),f=a(d)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function l(e,t,o){var a={start:s.pixelToCanvas(e,t.handles.start),end:s.pixelToCanvas(e,t.handles.end)},n=f.lineSegment.distanceToPoint(a,o);return n<5||(a.start=s.pixelToCanvas(e,t.handles.start2),a.end=s.pixelToCanvas(e,t.handles.end2),(n=f.lineSegment.distanceToPoint(a,o))<5)}function i(e,t){var o=(0,O.getToolState)(e.currentTarget,k);if(void 0!==o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var n=void 0,r=b.default.getToolWidth(),l=x.default.getFont(),i=_.getConfiguration(),u=0;u<o.data.length;u++){a.save(),i&&i.shadow&&(a.shadowColor=i.shadowColor||"#000000",a.shadowOffsetX=i.shadowOffsetX||1,a.shadowOffsetY=i.shadowOffsetY||1);var d=o.data[u];n=d.active?w.default.getActiveColor():w.default.getToolColor(),a.beginPath(),a.strokeStyle=n,a.lineWidth=r;var f=s.pixelToCanvas(t.element,d.handles.start),c=s.pixelToCanvas(t.element,d.handles.end);a.moveTo(f.x,f.y),a.lineTo(c.x,c.y),f=s.pixelToCanvas(t.element,d.handles.start2),c=s.pixelToCanvas(t.element,d.handles.end2),a.moveTo(f.x,f.y),a.lineTo(c.x,c.y),a.stroke(),(0,I.default)(a,t,d.handles),a.fillStyle=n;var g=(Math.ceil(d.handles.start.x)-Math.ceil(d.handles.end.x))*t.image.columnPixelSpacing,v=(Math.ceil(d.handles.start.y)-Math.ceil(d.handles.end.y))*t.image.rowPixelSpacing,m=(Math.ceil(d.handles.start2.x)-Math.ceil(d.handles.end2.x))*t.image.columnPixelSpacing,h=(Math.ceil(d.handles.start2.y)-Math.ceil(d.handles.end2.y))*t.image.rowPixelSpacing,T=Math.acos(Math.abs((g*m+v*h)/(Math.sqrt(g*g+v*v)*Math.sqrt(m*m+h*h))));T*=180/Math.PI;var C=(0,y.default)(T,2),M=C.toString()+String.fromCharCode(parseInt("00B0",16)),P=(f.x+c.x)/2,S=(f.y+c.y)/2;a.font=l,(0,p.default)(a,M,P,S,n),a.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var u=o(0),s=n(u),d=o(3),f=n(d),c=o(8),g=a(c),v=o(10),m=a(v),h=o(7),p=a(h),T=o(37),y=a(T),C=o(6),b=a(C),M=o(15),x=a(M),P=o(5),w=a(P),S=o(9),I=a(S),O=o(2),k="angle",_=(0,g.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:k}),D=(0,m.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:k});t.angle=_,t.angleTouch=D},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){e(prompt("Enter your annotation:"))}function l(e,t,o){o(prompt("Change your annotation:"))}function i(e){function t(t){null===t?(0,X.removeToolState)(e.element,q,o):o.text=t,o.active=!1,p.updateImage(e.element),(0,m.default)(e.element).on("CornerstoneToolsMouseMove",a,G.mouseMoveCallback),(0,m.default)(e.element).on("CornerstoneToolsMouseDown",a,G.mouseDownCallback),(0,m.default)(e.element).on("CornerstoneToolsMouseDownActivate",a,G.mouseDownActivateCallback),(0,m.default)(e.element).on("CornerstoneToolsMouseDoubleClick",a,G.mouseDoubleClickCallback)}var o=u(e),a={mouseButtonMask:e.which};(0,X.addToolState)(e.element,q,o),(0,m.default)(e.element).off("CornerstoneToolsMouseMove",G.mouseMoveCallback),(0,m.default)(e.element).off("CornerstoneToolsMouseDown",G.mouseDownCallback),(0,m.default)(e.element).off("CornerstoneToolsMouseDownActivate",G.mouseDownActivateCallback),(0,m.default)(e.element).off("CornerstoneToolsMouseDoubleClick",G.mouseDoubleClickCallback),p.updateImage(e.element),(0,N.default)(e,q,o,o.handles.end,function(){(0,L.default)(e,o.handles)&&(0,X.removeToolState)(e.element,q,o);var a=G.getConfiguration();void 0===o.text&&a.getTextCallback(t),p.updateImage(e.element)})}function u(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function s(e,t,o){var a={start:p.pixelToCanvas(e,t.handles.start),end:p.pixelToCanvas(e,t.handles.end)};return y.lineSegment.distanceToPoint(a,o)<25}function d(e,t){var o=(0,X.getToolState)(e.currentTarget,q);if(o){var a=t.enabledElement,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var r=void 0,l=I.default.getToolWidth(),i=k.default.getFont(),u=G.getConfiguration(),s=0;s<o.data.length;s++){n.save(),u&&u.shadow&&(n.shadowColor=u.shadowColor||"#000000",n.shadowOffsetX=u.shadowOffsetX||1,n.shadowOffsetY=u.shadowOffsetY||1);var d=o.data[s];r=d.active?D.default.getActiveColor():D.default.getToolColor();var f=p.pixelToCanvas(t.element,d.handles.start),c=p.pixelToCanvas(t.element,d.handles.end);u.arrowFirst?(0,A.default)(n,c,f,r,l):(0,A.default)(n,f,c,r,l);var g={drawHandlesIfActive:u&&u.drawHandlesOnHover};if(u.drawHandles&&(0,E.default)(n,t,d.handles,r,g),d.text&&""!==d.text){n.font=i;var v=n.measureText(d.text).width+10,m=k.default.getFontSize()+10,h=Math.max(v,m)/2+5;c.x<f.x&&(h=-h);var T=void 0;if(!d.handles.textBox.hasMoved){T=u.arrowFirst?{x:c.x-v/2+h,y:c.y-m/2}:{x:f.x-v/2-h,y:f.y-m/2};var C=p.internal.getTransform(a);C.invert();var b=C.transformPoint(T.x,T.y);d.handles.textBox.x=b.x,d.handles.textBox.y=b.y}T=p.pixelToCanvas(t.element,d.handles.textBox);var M=(0,w.default)(n,d.text,T.x,T.y,r);if(d.handles.textBox.boundingBox=M,d.handles.textBox.hasMoved){var x={start:{},end:{}},P={x:(f.x+c.x)/2,y:(f.y+c.y)/2},S=[f,c,P];x.end.x=T.x,x.end.y=T.y,x.start=y.point.findClosestPoint(S,x.end);var O=[{x:M.left+M.width/2,y:M.top},{x:M.left,y:M.top+M.height/2},{x:M.left+M.width/2,y:M.top+M.height},{x:M.left+M.width,y:M.top+M.height/2}];x.end=y.point.findClosestPoint(O,x.start),n.beginPath(),n.strokeStyle=r,n.lineWidth=l,n.setLineDash([2,3]),n.moveTo(x.start.x,x.start.y),n.lineTo(x.end.x,x.end.y),n.stroke()}}n.restore()}}}function f(e){function t(e){null===e?(0,X.removeToolState)(o,q,a):a.text=e,a.active=!1,p.updateImage(o),(0,m.default)(o).on("CornerstoneToolsTouchPress",Z.pressCallback),(0,m.default)(o).on("CornerstoneToolsTouchStartActive",Z.touchDownActivateCallback),(0,m.default)(o).on("CornerstoneToolsTap",Z.tapCallback)}var o=e.element,a=u(e);(0,X.addToolState)(o,q,a),(0,m.default)(o).off("CornerstoneToolsTouchPress",Z.pressCallback),(0,m.default)(o).off("CornerstoneToolsTouchStartActive",Z.touchDownActivateCallback),(0,m.default)(o).off("CornerstoneToolsTap",Z.tapCallback),p.updateImage(o),(0,V.default)(e,q,a,a.handles.end,function(){p.updateImage(o),(0,L.default)(e,a.handles)&&(0,X.removeToolState)(o,q,a);var n=G.getConfiguration();void 0===a.text&&n.getTextCallback(t)})}function c(e,t){function o(e,t,o){!0===o?(0,X.removeToolState)(a,q,e):e.text=t,e.active=!1,p.updateImage(a)}var a=t.element,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,F.default)(t.which,e.data.mouseButtonMask)){var r=G.getConfiguration(),l=t.currentPoints.canvas,i=(0,X.getToolState)(a,q);if(i)for(var u=0;u<i.data.length;u++)if(n=i.data[u],s(a,n,l)||(0,U.default)(n.handles.textBox,l))return n.active=!0,p.updateImage(a),r.changeTextCallback(n,t,o),e.stopImmediatePropagation(),!1}}function g(e,t){function o(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,X.removeToolState)(a,q,e):e.text=t,e.active=!1,p.updateImage(a),(0,m.default)(a).on("CornerstoneToolsTouchStart",Z.touchStartCallback),(0,m.default)(a).on("CornerstoneToolsTouchStartActive",Z.touchDownActivateCallback),(0,m.default)(a).on("CornerstoneToolsTap",Z.tapCallback)}var a=t.element,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,F.default)(t.which,e.data.mouseButtonMask)){var r=G.getConfiguration(),l=t.currentPoints.canvas,i=(0,X.getToolState)(a,q);if(i){if(t.handlePressed)return(0,m.default)(a).off("CornerstoneToolsTouchStart",Z.touchStartCallback),(0,m.default)(a).off("CornerstoneToolsTouchStartActive",Z.touchDownActivateCallback),(0,m.default)(a).off("CornerstoneToolsTap",Z.tapCallback),r.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var u=0;u<i.data.length;u++)if(n=i.data[u],s(a,n,l)||(0,U.default)(n.handles.textBox,l))return n.active=!0,p.updateImage(a),(0,m.default)(a).off("CornerstoneToolsTouchStart",Z.touchStartCallback),(0,m.default)(a).off("CornerstoneToolsTouchStartActive",Z.touchDownActivateCallback),(0,m.default)(a).off("CornerstoneToolsTap",Z.tapCallback),r.changeTextCallback(n,t,o),e.stopImmediatePropagation(),!1;return!1}}}Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var v=o(1),m=n(v),h=o(0),p=a(h),T=o(3),y=a(T),C=o(8),b=n(C),M=o(10),x=n(M),P=o(7),w=n(P),S=o(6),I=n(S),O=o(15),k=n(O),_=o(5),D=n(_),j=o(9),E=n(j),R=o(49),A=n(R),B=o(23),N=n(B),H=o(24),V=n(H),W=o(13),L=n(W),Y=o(4),F=n(Y),z=o(19),U=n(z),X=o(2),q="arrowAnnotate",K={getTextCallback:r,changeTextCallback:l,drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0},G=(0,b.default)({addNewMeasurement:i,createNewMeasurement:u,onImageRendered:d,pointNearTool:s,toolType:q,mouseDoubleClickCallback:c});G.setConfiguration(K);var Z=(0,x.default)({addNewMeasurement:f,createNewMeasurement:u,onImageRendered:d,pointNearTool:s,toolType:q,pressCallback:g});t.arrowAnnotate=G,t.arrowAnnotateTouch=Z},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){e.stopImmediatePropagation();var o=(0,b.getToolState)(e.currentTarget,w);if(o){var a=e.currentTarget,n=T.getEnabledElement(a),r=n.image.imageId,l=T.metaData.get("imagePlane",r),i=t.currentPoints.image,u=(0,P.imagePointToPatientPoint)(i,l);o.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==a){var t=Number.MAX_VALUE,o=-1,n=(0,b.getToolState)(e,"stack");if(void 0!==n){var r=n.data[0];if(r.imageIds.forEach(function(e,a){var n=T.metaData.get("imagePlane",e),r=n.imagePositionPatient,l=n.rowCosines.clone(),i=n.columnCosines.clone(),s=i.clone().cross(l.clone()),d=Math.abs(s.clone().dot(r)-s.clone().dot(u));d<t&&(t=d,o=a)}),o!==r.currentImageIdIndex&&-1!==o&&void 0!==r.imageIds[o]){var l=C.default.getStartLoadHandler(),i=C.default.getEndLoadHandler(),s=C.default.getErrorLoadingHandler();l&&l(e);var d=void 0;d=!0===r.preventCache?T.loadImage(r.imageIds[o]):T.loadAndCacheImage(r.imageIds[o]),d.then(function(t){var a=T.getViewport(e);r.currentImageIdIndex=o,T.displayImage(e,t,a),i&&i(e,t)},function(t){var a=r.imageIds[o];s&&s(e,a,t)})}}}})}}function r(e,t){(0,h.default)(t.element).off("CornerstoneToolsMouseDrag",i),(0,h.default)(t.element).off("CornerstoneToolsMouseUp",r)}function l(e,t){if((0,x.default)(t.which,e.data.mouseButtonMask))return(0,h.default)(t.element).on("CornerstoneToolsMouseDrag",i),(0,h.default)(t.element).on("CornerstoneToolsMouseUp",r),n(e,t),!1}function i(e,t){return n(e,t),!1}function u(e,t,o){var a={mouseButtonMask:t};(0,b.clearToolState)(e,w),(0,b.addToolState)(e,w,{synchronizationContext:o}),(0,h.default)(e).off("CornerstoneToolsMouseDown",l),(0,h.default)(e).on("CornerstoneToolsMouseDown",a,l)}function s(e){(0,h.default)(e).off("CornerstoneToolsMouseDown",l)}function d(e,t){(0,h.default)(t.element).off("CornerstoneToolsTouchDrag",c),(0,h.default)(t.element).off("CornerstoneToolsDragEnd",d)}function f(e,t){return(0,h.default)(t.element).on("CornerstoneToolsTouchDrag",c),(0,h.default)(t.element).on("CornerstoneToolsDragEnd",d),n(e,t),!1}function c(e,t){return n(e,t),!1}function g(e,t){(0,b.clearToolState)(e,w),(0,b.addToolState)(e,w,{synchronizationContext:t}),(0,h.default)(e).off("CornerstoneToolsTouchStart",f),(0,h.default)(e).on("CornerstoneToolsTouchStart",f)}function v(e){(0,h.default)(e).off("CornerstoneToolsTouchStart",f)}Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var m=o(1),h=a(m),p=o(0),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(p),y=o(11),C=a(y),b=o(2),M=o(4),x=a(M),P=o(36),w="crosshairs",S={activate:u,deactivate:s,enable:u,disable:s},I={activate:g,deactivate:v,enable:g,disable:v};t.crosshairs=S,t.crosshairsTouch=I},function(e,t,o){"use strict";function a(e){l.fitToWindow(e.element)}function n(e,t){return s.strategy(t),!1}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r),i=o(39),u=function(e){return e&&e.__esModule?e:{default:e}}(i),s=(0,u.default)(n);s.strategies={default:a},s.strategy=a,t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=g.getEnabledElement(e.element),o=t.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);var a=b.default.getActiveColor(),n=y.default.getFont(),r=y.default.getFontSize(),l=D.getConfiguration();o.save(),l&&l.shadow&&(o.shadowColor=l.shadowColor||"#000000",o.shadowOffsetX=l.shadowOffsetX||1,o.shadowOffsetY=l.shadowOffsetY||1);var i=Math.round(e.currentPoints.image.x),u=Math.round(e.currentPoints.image.y),s=void 0,d=void 0,f=void 0;if(!(i<0||u<0||i>=e.image.columns||u>=e.image.rows)){if(e.image.color)s=(0,w.default)(e.element,i,u,1,1),d=i+", "+u,f="R: "+s[0]+" G: "+s[1]+" B: "+s[2]+" A: "+s[3];else{s=g.getStoredPixels(e.element,i,u,1,1);var c=s[0],v=c*e.image.slope+e.image.intercept,m=(0,I.default)(e.image,c);d=i+", "+u,f="SP: "+c+" MO: "+parseFloat(v.toFixed(3)),m&&(f+=" SUV: "+parseFloat(m.toFixed(3)))}var h={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},p=g.pixelToCanvas(e.element,h);o.font=n,o.fillStyle=a,(0,x.default)(o,f,p.x,p.y+r+5,a),(0,x.default)(o,d,p.x,p.y,a),o.restore()}}function r(e){var t=e.element,o=g.getEnabledElement(t),a=o.image,n=o.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var r=b.default.getActiveColor(),l=y.default.getFont(),i=D.getConfiguration();n.save(),i&&i.shadow&&(n.shadowColor=i.shadowColor||"#000000",n.shadowOffsetX=i.shadowOffsetX||1,n.shadowOffsetY=i.shadowOffsetY||1);var u=g.metaData.get("generalSeriesModule",a.imageId),s=void 0;u&&(s=u.modality);var d=void 0;d=!0===e.isTouchEvent?g.pageToPixel(t,e.currentPoints.page.x,e.currentPoints.page.y-4*y.default.getFontSize()):g.pageToPixel(t,e.currentPoints.page.x,e.currentPoints.page.y-y.default.getFontSize()/2);var f=void 0,c="";if(!(d.x<0||d.y<0||d.x>=a.columns||d.y>=a.rows)){if(a.color)f=(0,w.default)(t,d.x,d.y,1,1),c="R: "+f[0]+" G: "+f[1]+" B: "+f[2];else{f=g.getStoredPixels(t,d.x,d.y,1,1);var v=f[0],m=v*e.image.slope+e.image.intercept,h=parseFloat(m.toFixed(2));if("CT"===s)c+="HU: "+h;else if("PT"===s){c+=h;var p=(0,I.default)(e.image,v);p&&(c+=" SUV: "+parseFloat(p.toFixed(2)))}else c+=h}var T=g.pixelToCanvas(t,d);n.font=l,n.fillStyle=r;var C=void 0,M=n.measureText(c).width;C=!0===e.isTouchEvent?{x:-M/2-5,y:-y.default.getFontSize()-10-12}:{x:12,y:-(y.default.getFontSize()+10)/2},n.beginPath(),n.strokeStyle=r,n.arc(T.x,T.y,6,0,2*Math.PI),n.stroke(),(0,x.default)(n,c,T.x+C.x,T.y+C.y,r),n.restore()}}function l(e,t){var o=t.element;(0,f.default)(o).off("CornerstoneImageRendered",u),(0,f.default)(o).off("CornerstoneToolsMouseDrag",s),(0,f.default)(o).off("CornerstoneToolsMouseUp",l),(0,f.default)(o).off("CornerstoneToolsMouseClick",l),g.updateImage(t.element)}function i(e,t){var o=t.element;if((0,k.default)(t.which,e.data.mouseButtonMask))return(0,f.default)(o).on("CornerstoneImageRendered",u),(0,f.default)(o).on("CornerstoneToolsMouseDrag",s),(0,f.default)(o).on("CornerstoneToolsMouseUp",l),(0,f.default)(o).on("CornerstoneToolsMouseClick",l),D.strategy(t),!1}function u(){_&&(D.strategy(_),_=null)}function s(e,t){var o=t.element;return _=t,g.updateImage(o),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var d=o(1),f=a(d),c=o(0),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(c),v=o(14),m=a(v),h=o(12),p=a(h),T=o(15),y=a(T),C=o(5),b=a(C),M=o(7),x=a(M),P=o(33),w=a(P),S=o(18),I=a(S),O=o(4),k=a(O),_=void 0,D=(0,m.default)(i);D.strategies={default:n,minimal:r},D.strategy=n;var j={fireOnTouchStart:!0},E=(0,p.default)(s,j);t.dragProbe=D,t.dragProbeTouch=E},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function l(e,t,o,a){var n=c.pixelToCanvas(e,t.handles.start),r=c.pixelToCanvas(e,t.handles.end),l={left:Math.min(n.x,r.x)+a/2,top:Math.min(n.y,r.y)+a/2,width:Math.abs(n.x-r.x)-a,height:Math.abs(n.y-r.y)-a},i={left:Math.min(n.x,r.x)-a/2,top:Math.min(n.y,r.y)-a/2,width:Math.abs(n.x-r.x)+a,height:Math.abs(n.y-r.y)+a},u=(0,_.default)(l,o);return!(!(0,_.default)(i,o)||u)}function i(e,t,o){return l(e,t,o,15)}function u(e,t,o){return l(e,t,o,25)}function s(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function d(e,t){var o=(0,A.getToolState)(e.currentTarget,B);if(o){var a=t.image,n=t.element,r=C.default.getToolWidth(),l=N.getConfiguration(),i=t.canvasContext.canvas.getContext("2d"),u=c.metaData.get("generalSeriesModule",a.imageId),d=void 0;u&&(d=u.modality),i.setTransform(1,0,0,1,0,0);for(var f=0;f<o.data.length;f++){i.save();var g=o.data[f];l&&l.shadow&&(i.shadowColor=l.shadowColor||"#000000",i.shadowOffsetX=l.shadowOffsetX||1,i.shadowOffsetY=l.shadowOffsetY||1);var m=M.default.getColorIfActive(g.active),h=c.pixelToCanvas(n,g.handles.start),p=c.pixelToCanvas(n,g.handles.end),T=Math.min(h.x,p.x),y=Math.min(h.y,p.y),b=Math.abs(h.x-p.x),x=Math.abs(h.y-p.y);if(i.beginPath(),i.strokeStyle=m,i.lineWidth=r,(0,O.default)(i,T,y,b,x),i.closePath(),l&&l.drawHandlesOnHover)if(!0===g.active)(0,P.default)(i,t,g.handles,m);else{var w={drawHandlesIfActive:!0};(0,P.default)(i,t,g.handles,m,w)}else(0,P.default)(i,t,g.handles,m);var I=void 0,k=void 0,_=void 0;if(!1===g.invalidated)k=g.meanStdDev,_=g.meanStdDevSUV,I=g.area;else{var D={left:Math.round(Math.min(g.handles.start.x,g.handles.end.x)),top:Math.round(Math.min(g.handles.start.y,g.handles.end.y)),width:Math.round(Math.abs(g.handles.start.x-g.handles.end.x)),height:Math.round(Math.abs(g.handles.start.y-g.handles.end.y))};if(!a.color){var E=c.getPixels(n,D.left,D.top,D.width,D.height);k=(0,j.default)(E,D),"PT"===d&&(_={mean:(0,R.default)(a,(k.mean-a.intercept)/a.slope),stdDev:(0,R.default)(a,(k.stdDev-a.intercept)/a.slope)}),k&&!isNaN(k.mean)&&(g.meanStdDev=k,g.meanStdDevSUV=_)}var H=a.columnPixelSpacing||1,V=a.rowPixelSpacing||1;I=Math.PI*(D.width*H/2)*(D.height*V/2),isNaN(I)||(g.area=I),g.invalidated=!1}var W=[];if(k&&void 0!==k.mean){var L="";"CT"===d&&(L=" HU");var Y="Mean: "+s(k.mean.toFixed(2))+L,F="StdDev: "+s(k.stdDev.toFixed(2))+L;if(_&&void 0!==_.mean){Y+=" SUV: "+s(_.mean.toFixed(2)),F+=" SUV: "+s(_.stdDev.toFixed(2))}W.push(Y),W.push(F)}if(I){var z=" mm"+String.fromCharCode(178);a.rowPixelSpacing&&a.columnPixelSpacing||(z=" pixels"+String.fromCharCode(178));var U="Area: "+s(I.toFixed(2))+z;W.push(U)}g.handles.textBox.hasMoved||(g.handles.textBox.x=Math.max(g.handles.start.x,g.handles.end.x),g.handles.textBox.y=(g.handles.start.y+g.handles.end.y)/2);var X=c.pixelToCanvas(n,g.handles.textBox),q={centering:{x:!1,y:!0}},K=(0,S.default)(i,W,X.x,X.y,m,q);if(g.handles.textBox.boundingBox=K,g.handles.textBox.hasMoved){var G={start:{},end:{x:X.x,y:X.y}},Z=[{x:T+b/2,y:y},{x:T,y:y+x/2},{x:T+b/2,y:y+x},{x:T+b,y:y+x/2}];G.start=v.point.findClosestPoint(Z,G.end);var $=[{x:K.left+K.width/2,y:K.top},{x:K.left,y:K.top+K.height/2},{x:K.left+K.width/2,y:K.top+K.height},{x:K.left+K.width,y:K.top+K.height/2}];G.end=v.point.findClosestPoint($,G.start),i.beginPath(),i.strokeStyle=m,i.lineWidth=r,i.setLineDash([2,3]),i.moveTo(G.start.x,G.start.y),i.lineTo(G.end.x,G.end.y),i.stroke()}i.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var f=o(0),c=n(f),g=o(3),v=n(g),m=o(8),h=a(m),p=o(10),T=a(p),y=o(6),C=a(y),b=o(5),M=a(b),x=o(9),P=a(x),w=o(7),S=a(w),I=o(51),O=a(I),k=o(35),_=a(k),D=o(48),j=a(D),E=o(18),R=a(E),A=o(2),B="ellipticalRoi",N=(0,h.default)({createNewMeasurement:r,onImageRendered:d,pointNearTool:i,toolType:B}),H=(0,T.default)({createNewMeasurement:r,onImageRendered:d,pointNearTool:u,toolType:B});t.ellipticalRoi=N,t.ellipticalRoiTouch=H},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=(0,R.getToolState)(e.element,A);if(void 0!==t){var o=N.getConfiguration(),a=t.data[o.currentTool],n={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};a.handles.length&&a.handles[o.currentHandle-1].lines.push(e.currentPoints.image),a.handles.push(n),o.currentHandle+=1,o.freehand=!1,x.updateImage(e.element)}}function l(e,t){var o=(0,R.getToolState)(e.element,A);if(void 0!==o){var a=o.data[t];if(void 0!==a.handles)for(var n=e.currentPoints.canvas,r=0;r<a.handles.length;r++){var l=x.pixelToCanvas(e.element,a.handles[r]);if(w.point.distance(l,n)<5)return r}}}function i(e){var t=(0,R.getToolState)(e.element,A);if(t)for(var o=void 0,a=0;a<t.data.length;a++)if(void 0!==(o=l(e,a)))return{handleNearby:o,toolIndex:a}}function u(e,t){if((0,b.default)(t.element).off("CornerstoneToolsMouseUp",u),void 0!==(0,R.getToolState)(t.element,A)){var o=N.getConfiguration();t.event.shiftKey||(o.freehand=!1),x.updateImage(t.element)}}function s(e,t){var o=(0,R.getToolState)(t.element,A);if(o){var a=N.getConfiguration(),n=o.data[a.currentTool],r=Math.max(t.currentPoints.image.x,0);r=Math.min(r,t.image.width),a.mouseLocation.handles.start.x=r;var i=Math.max(t.currentPoints.image.y,0);i=Math.min(i,t.image.height),a.mouseLocation.handles.start.y=i;var u=a.currentHandle;if(a.modifying&&(n.active=!0,n.highlight=!0,n.handles[u].x=a.mouseLocation.handles.start.x,n.handles[u].y=a.mouseLocation.handles.start.y,u)){var s=n.handles[u-1].lines.length-1,d=n.handles[u-1].lines[s];d.x=a.mouseLocation.handles.start.x,d.y=a.mouseLocation.handles.start.y}if(a.freehand)n.handles[u-1].lines.push(t.currentPoints.image);else{var f=l(t,a.currentTool);void 0!==f&&f<n.handles.length-1&&(a.mouseLocation.handles.start.x=n.handles[f].x,a.mouseLocation.handles.start.y=n.handles[f].y)}x.updateImage(t.element)}}function d(e){(0,b.default)(e.element).on("CornerstoneToolsMouseMove",s),(0,b.default)(e.element).on("CornerstoneToolsMouseUp",u);var t={visible:!0,active:!0,handles:[]},o=N.getConfiguration();o.mouseLocation.handles.start.x=e.currentPoints.image.x,o.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,R.addToolState)(e.element,A,t);var a=(0,R.getToolState)(e.element,A);o.currentTool=a.data.length-1}function f(e,t){var o=(0,R.getToolState)(e.element,A);if(o){var a=N.getConfiguration(),n=o.data[a.currentTool];n.active=!1,n.highlight=!1,void 0!==t&&n.handles[a.currentHandle-1].lines.push({x:n.handles[t].x,y:n.handles[t].y}),a.modifying&&(a.modifying=!1),a.currentHandle=0,a.currentTool=-1,(0,b.default)(e.element).off("CornerstoneToolsMouseMove",s),x.updateImage(e.element)}}function c(e,t){if((0,E.default)(t.which,e.data.mouseButtonMask)){var o=(0,R.getToolState)(t.element,A),a=void 0,n=void 0,c=N.getConfiguration(),g=c.currentTool;if(c.modifying)return void f(t);if(g<0){var v=i(t);v?(a=v.handleNearby,n=v.toolIndex,void 0!==a&&((0,b.default)(t.element).on("CornerstoneToolsMouseMove",s),(0,b.default)(t.element).on("CornerstoneToolsMouseUp",u),c.modifying=!0,c.currentHandle=a,c.currentTool=n)):(d(t),r(t))}else g>=0&&o.data[g].active&&(a=l(t,g),void 0!==a?f(t,a):t.event.shiftKey?c.freehand=!0:r(t));return!1}}function g(e,t){var o=(0,R.getToolState)(e.currentTarget,A);if(void 0!==o){var a=N.getConfiguration(),n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var r=void 0,l=I.default.getToolWidth(),i=k.default.getFillColor(),u=0;u<o.data.length;u++){n.save();var s=o.data[u];s.active?(r=k.default.getActiveColor(),i=k.default.getFillColor()):(r=k.default.getToolColor(),i=k.default.getToolColor());var d=void 0;if(s.handles.length)for(var f=0;f<s.handles.length;f++){d=s.handles[f];var c=x.pixelToCanvas(t.element,d);n.beginPath(),n.strokeStyle=r,n.lineWidth=l,n.moveTo(c.x,c.y);for(var g=0;g<s.handles[f].lines.length;g++){var v=x.pixelToCanvas(t.element,s.handles[f].lines[g]);n.lineTo(v.x,v.y),n.stroke()}var m=x.pixelToCanvas(t.element,a.mouseLocation.handles.start);f===s.handles.length-1&&(!s.active||a.freehand||a.modifying||(n.lineTo(m.x,m.y),n.stroke()))}var h={fill:i};s.active&&(0,D.default)(n,t,a.mouseLocation.handles,r,h),(0,D.default)(n,t,s.handles,r,h),n.restore()}}}function v(e){(0,b.default)(e).off("CornerstoneToolsMouseDown",c),(0,b.default)(e).off("CornerstoneToolsMouseUp",u),(0,b.default)(e).off("CornerstoneToolsMouseMove",s),(0,b.default)(e).off("CornerstoneImageRendered",g),(0,b.default)(e).on("CornerstoneImageRendered",g),x.updateImage(e)}function m(e){(0,b.default)(e).off("CornerstoneToolsMouseDown",c),(0,b.default)(e).off("CornerstoneToolsMouseUp",u),(0,b.default)(e).off("CornerstoneToolsMouseMove",s),(0,b.default)(e).off("CornerstoneImageRendered",g),x.updateImage(e)}function h(e,t){var o={mouseButtonMask:t};(0,b.default)(e).off("CornerstoneToolsMouseDown",o,c),(0,b.default)(e).off("CornerstoneToolsMouseUp",u),(0,b.default)(e).off("CornerstoneToolsMouseMove",s),(0,b.default)(e).off("CornerstoneImageRendered",g),(0,b.default)(e).on("CornerstoneImageRendered",g),(0,b.default)(e).on("CornerstoneToolsMouseDown",o,c),x.updateImage(e)}function p(e){(0,b.default)(e).off("CornerstoneToolsMouseDown",c),(0,b.default)(e).off("CornerstoneToolsMouseUp",u),(0,b.default)(e).off("CornerstoneToolsMouseMove",s),(0,b.default)(e).off("CornerstoneImageRendered",g),(0,b.default)(e).on("CornerstoneImageRendered",g),x.updateImage(e)}function T(){return B}function y(e){B=e}Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var C=o(1),b=n(C),M=o(0),x=a(M),P=o(3),w=a(P),S=o(6),I=n(S),O=o(5),k=n(O),_=o(9),D=n(_),j=o(4),E=n(j),R=o(2),A="freehand",B={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,currentHandle:0,currentTool:-1},N={enable:v,disable:m,activate:h,deactivate:p,getConfiguration:T,setConfiguration:y};t.freehand=N},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){var t=(0,x.getToolState)(e.event.currentTarget,P);if(!(t&&t.data&&t.data.length>0)){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}}function l(e,t,o){var a=d.pixelToCanvas(e,t.handles.start),n=d.pixelToCanvas(e,t.handles.end),r={left:Math.min(a.x,n.x),top:Math.min(a.y,n.y),width:Math.abs(a.x-n.x),height:Math.abs(a.y-n.y)},l=!1;return o.x>=r.left&&o.x<=r.left+r.width&&o.y>=r.top&&o.y<=r.top+r.height&&(l=!0),l}function i(e,t,o){var a=d.pixelToCanvas(e,t.handles.start),n=d.pixelToCanvas(e,t.handles.end),r={left:Math.min(a.x,n.x),top:Math.min(a.y,n.y),width:Math.abs(a.x-n.x),height:Math.abs(a.y-n.y)};return c.rect.distanceToPoint(r,o)<5}function u(e,t){var o=(0,x.getToolState)(e.currentTarget,P);if(void 0!==o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);var n=void 0,r=T.default.getToolWidth();a.save();var l=o.data[0];if(l){n=l.active?C.default.getActiveColor():C.default.getToolColor();var i=d.pixelToCanvas(t.element,l.handles.start),u=d.pixelToCanvas(t.element,l.handles.end),s={left:Math.min(i.x,u.x),top:Math.min(i.y,u.y),width:Math.abs(i.x-u.x),height:Math.abs(i.y-u.y)};a.beginPath(),a.strokeStyle="transparent",a.rect(0,0,a.canvas.clientWidth,a.canvas.clientHeight),a.rect(s.width+s.left,s.top,-s.width,s.height),a.stroke(),a.fillStyle="rgba(0,0,0,0.7)",a.fill(),a.closePath(),a.beginPath(),a.strokeStyle=n,a.lineWidth=r,a.setLineDash([4]),a.strokeRect(s.left,s.top,s.width,s.height),a.setLineDash([]),(0,M.default)(a,t,l.handles,n),a.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var s=o(0),d=n(s),f=o(3),c=n(f),g=o(41),v=a(g),m=o(10),h=a(m),p=o(6),T=a(p),y=o(5),C=a(y),b=o(9),M=a(b),x=o(2),P="highlight",w=(0,v.default)({createNewMeasurement:r,onImageRendered:u,pointNearTool:i,pointInsideRect:l,toolType:P},!0),S=(0,h.default)({createNewMeasurement:r,onImageRendered:u,pointNearTool:i,pointInsideRect:l,toolType:P},!0);t.highlight=w,t.highlightTouch=S},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=t.image,a=o.stats,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var r=[];Object.keys(a).forEach(function(e){var t=e+" : "+a[e];r.push(t)}),(0,u.default)(n,r,0,0,"orange"),r.forEach(function(e){console.log(e)})}Object.defineProperty(t,"__esModule",{value:!0});var r=o(20),l=a(r),i=o(7),u=a(i),s=(0,l.default)(n);t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function l(e,t,o){var a={start:s.pixelToCanvas(e,t.handles.start),end:s.pixelToCanvas(e,t.handles.end)};return f.lineSegment.distanceToPoint(a,o)<25}function i(e,t){var o=(0,P.getToolState)(e.currentTarget,w);if(o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var n=y.default.getToolWidth(),r=S.getConfiguration(),l=0;l<o.data.length;l++){a.save(),r&&r.shadow&&(a.shadowColor=r.shadowColor||"#000000",a.shadowOffsetX=r.shadowOffsetX||1,a.shadowOffsetY=r.shadowOffsetY||1);var i=o.data[l],u=b.default.getColorIfActive(i.active),d=s.pixelToCanvas(t.element,i.handles.start),c=s.pixelToCanvas(t.element,i.handles.end);a.beginPath(),a.strokeStyle=u,a.lineWidth=n,a.moveTo(d.x,d.y),a.lineTo(c.x,c.y),a.stroke();var g={drawHandlesIfActive:r&&r.drawHandlesOnHover};(0,x.default)(a,t,i.handles,u,g),a.fillStyle=u;var v=(i.handles.end.x-i.handles.start.x)*(t.image.columnPixelSpacing||1),m=(i.handles.end.y-i.handles.start.y)*(t.image.rowPixelSpacing||1),h=Math.sqrt(v*v+m*m);i.length=h;var T=" mm";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(T=" pixels");var C=""+h.toFixed(2)+T;if(!i.handles.textBox.hasMoved){var M={x:Math.max(i.handles.start.x,i.handles.end.x)};M.x===i.handles.start.x?M.y=i.handles.start.y:M.y=i.handles.end.y,i.handles.textBox.x=M.x,i.handles.textBox.y=M.y}var I=s.pixelToCanvas(t.element,i.handles.textBox);I.x+=10;var O={centering:{x:!1,y:!0}},k=(0,p.default)(a,C,I.x,I.y,u,O);if(i.handles.textBox.boundingBox=k,i.handles.textBox.hasMoved){var _={start:{},end:{}},D={x:(d.x+c.x)/2,y:(d.y+c.y)/2},j=[d,c,D];_.end.x=I.x,_.end.y=I.y,_.start=f.point.findClosestPoint(j,_.end);var E=[{x:k.left+k.width/2,y:k.top},{x:k.left,y:k.top+k.height/2},{x:k.left+k.width/2,y:k.top+k.height},{x:k.left+k.width,y:k.top+k.height/2}];_.end=f.point.findClosestPoint(E,_.start),a.beginPath(),a.strokeStyle=u,a.lineWidth=n,a.setLineDash([2,3]),a.moveTo(_.start.x,_.start.y),a.lineTo(_.end.x,_.end.y),a.stroke()}a.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var u=o(0),s=n(u),d=o(3),f=n(d),c=o(8),g=a(c),v=o(10),m=a(v),h=o(7),p=a(h),T=o(6),y=a(T),C=o(5),b=a(C),M=o(9),x=a(M),P=o(2),w="length",S=(0,g.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:w}),I=(0,m.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:w});t.length=S,t.lengthTouch=I},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=t.element;(0,y.default)(o).off("CornerstoneToolsMouseDrag",s),(0,y.default)(o).off("CornerstoneToolsMouseUp",n),(0,y.default)(o).off("CornerstoneToolsMouseClick",n),(0,y.default)(o).off("CornerstoneNewImage",i),r(t)}function r(e){(0,y.default)(e.element).find(".magnifyTool").hide(),document.body.style.cursor="default"}function l(e,t){var o=t.element;if((0,S.default)(t.which,e.data.mouseButtonMask))return(0,y.default)(o).on("CornerstoneToolsMouseDrag",t,s),(0,y.default)(o).on("CornerstoneToolsMouseUp",t,n),(0,y.default)(o).on("CornerstoneToolsMouseClick",t,n),k=t.currentPoints,(0,y.default)(o).on("CornerstoneNewImage",t,i),d(t),!1}function i(e,t){t.currentPoints=k,d(t)}function u(e,t){var o=t.element;(0,y.default)(t.element).off("CornerstoneToolsDragEnd",u),(0,y.default)(t.element).off("CornerstoneToolsTouchEnd",u),(0,y.default)(o).off("CornerstoneNewImage",i),r(t)}function s(e,t){return k=t.currentPoints,d(t),!0===t.isTouchEvent&&((0,y.default)(t.element).on("CornerstoneToolsDragEnd",u),(0,y.default)(t.element).on("CornerstoneToolsTouchEnd",u)),!1}function d(e){var t=(0,y.default)(e.element).find(".magnifyTool").get(0);t||f(e.element);var o=_.getConfiguration(),a=o.magnifySize,n=o.magnificationLevel,r=(0,y.default)(e.element).find("canvas").not(".magnifyTool").get(0);r.getContext("2d").setTransform(1,0,0,1,0,0);var l=t.getContext("2d");l.setTransform(1,0,0,1,0,0);var i=a/n,u=b.pixelToCanvas(e.element,e.currentPoints.image);!0===e.isTouchEvent&&(u.y-=1.25*i),u.x=Math.max(u.x,0),u.x=Math.min(u.x,r.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,r.height),l.clearRect(0,0,a,a),l.fillStyle="transparent",l.fillRect(0,0,a,a);var s={x:u.x-.5*i,y:u.y-.5*i};"Safari"===O&&(s.x=Math.max(s.x,0),s.y=Math.max(s.y,0)),s.x=Math.min(s.x,r.width),s.y=Math.min(s.y,r.height);var d={x:(r.width-s.x)*n,y:(r.height-s.y)*n};l.drawImage(r,s.x,s.y,r.width-s.x,r.height-s.y,0,0,d.x,d.y),t.style.top=u.y-.5*a+"px",t.style.left=u.x-.5*a+"px",t.style.display="block",document.body.style.cursor="none"}function f(e){if(0===(0,y.default)(e).find(".magnifyTool").length){var t=document.createElement("canvas");t.classList.add("magnifyTool");var o=_.getConfiguration();t.width=o.magnifySize,t.height=o.magnifySize,t.style.position="absolute",e.appendChild(t)}}function c(e){(0,y.default)(e).find(".magnifyTool").remove()}function g(e){(0,y.default)(e).off("CornerstoneToolsMouseDown",l),c(e)}function v(e){if(!O){var t=(0,P.getBrowserInfo)(),o=t.split(" ");O=o[0]}f(e)}function m(e,t){var o={mouseButtonMask:t};(0,y.default)(e).off("CornerstoneToolsMouseDown",l),(0,y.default)(e).on("CornerstoneToolsMouseDown",o,l),f(e)}function h(){return I}function p(e){I=e}Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var T=o(1),y=a(T),C=o(0),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(C),M=o(12),x=a(M),P=o(25),w=o(4),S=a(w),I={magnifySize:100,magnificationLevel:2},O=void 0,k=void 0,_={enable:v,activate:m,deactivate:g,disable:g,getConfiguration:h,setConfiguration:p},D={fireOnTouchStart:!0,activateCallback:f,disableCallback:c},j=(0,x.default)(s,D);t.magnify=_,t.magnifyTouchDrag=j},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=u.getEnabledElement(e),o=u.metaData.get("imagePlane",t.image.imageId);if(o&&o.rowCosines&&o.columnCosines){var a=d.default.getOrientationString(o.rowCosines),n=d.default.getOrientationString(o.columnCosines),r=d.default.invertOrientationString(a);return{top:d.default.invertOrientationString(n),bottom:n,left:r,right:a}}}function r(e){var t=u.getEnabledElement(e),o=void 0;o={x:t.image.width/2,y:5};var a=u.pixelToCanvas(e,o);o={x:t.image.width/2,y:t.image.height-5};var n=u.pixelToCanvas(e,o);o={x:5,y:t.image.height/2};var r=u.pixelToCanvas(e,o);return o={x:t.image.width-10,y:t.image.height/2},{top:a,bottom:n,left:r,right:u.pixelToCanvas(e,o)}}function l(e,t){var o=t.element,a=n(o);if(a){var l=r(o,a),i=t.canvasContext.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0);var u=v.default.getToolColor(),s={top:i.measureText(a.top).width,left:i.measureText(a.left).width,right:i.measureText(a.right).width,bottom:i.measureText(a.bottom).width};(0,h.default)(i,a.top,l.top.x-s.top/2,l.top.y,u),(0,h.default)(i,a.left,l.left.x-s.left/2,l.left.y,u);var d=p.getConfiguration();d&&d.drawAllMarkers&&((0,h.default)(i,a.right,l.right.x-s.right/2,l.right.y,u),(0,h.default)(i,a.bottom,l.bottom.x-s.bottom/2,l.bottom.y,u))}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(i),s=o(46),d=a(s),f=o(20),c=a(f),g=o(5),v=a(g),m=o(7),h=a(m),p=(0,c.default)(l);t.default=p},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){(0,u.default)(t.element).off("CornerstoneToolsMouseDrag",l),(0,u.default)(t.element).off("CornerstoneToolsMouseUp",n),(0,u.default)(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,h.default)(t.which,e.data.mouseButtonMask))return(0,u.default)(t.element).on("CornerstoneToolsMouseDrag",l),(0,u.default)(t.element).on("CornerstoneToolsMouseUp",n),(0,u.default)(t.element).on("CornerstoneToolsMouseClick",n),!1}function l(e,t){var o=t.viewport.scale,a=t.viewport.scale;return t.image.rowPixelSpacing<t.image.columnPixelSpacing?o*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(a*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/o,t.viewport.translation.y+=t.deltaPoints.page.y/a,d.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var i=o(1),u=a(i),s=o(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(s),f=o(14),c=a(f),g=o(12),v=a(g),m=o(4),h=a(m),p=(0,c.default)(r),T=(0,v.default)(l);t.pan=p,t.panTouchDrag=T},function(e,t,o){"use strict";function a(e,t){var o=s.getConfiguration();if(o&&o.testPointers(t))return t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,r.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),l=o(26),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u={testPointers:function(e){return e.numPointers>=2}},s=(0,i.default)(a);s.setConfiguration(u),t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function l(e,t,o){var a=s.pixelToCanvas(e,t.handles.end);return f.point.distance(a,o)<5}function i(e,t){var o=(0,O.getToolState)(e.currentTarget,k);if(o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var n=void 0,r=y.default.getFont(),l=y.default.getFontSize(),i=0;i<o.data.length;i++){a.save();var u=o.data[i];n=u.active?p.default.getActiveColor():p.default.getToolColor(),(0,b.default)(a,t,u.handles,n);var d=Math.round(u.handles.end.x),f=Math.round(u.handles.end.y),c=void 0,g=void 0,v=void 0;if(d<0||f<0||d>=t.image.columns||f>=t.image.rows)return;if(t.image.color)g=d+", "+f,c=(0,w.default)(t.element,d,f,1,1),v="R: "+c[0]+" G: "+c[1]+" B: "+c[2];else{c=s.getStoredPixels(t.element,d,f,1,1);var m=c[0],h=m*t.image.slope+t.image.intercept,T=(0,I.default)(t.image,m);g=d+", "+f,v="SP: "+m+" MO: "+parseFloat(h.toFixed(3)),T&&(v+=" SUV: "+parseFloat(T.toFixed(3)))}var C={x:u.handles.end.x+3,y:u.handles.end.y-3},M=s.pixelToCanvas(t.element,C);a.font=r,a.fillStyle=n,(0,x.default)(a,v,M.x,M.y+l+5,n),(0,x.default)(a,g,M.x,M.y,n),a.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var u=o(0),s=n(u),d=o(3),f=n(d),c=o(8),g=a(c),v=o(10),m=a(v),h=o(5),p=a(h),T=o(15),y=a(T),C=o(9),b=a(C),M=o(7),x=a(M),P=o(33),w=a(P),S=o(18),I=a(S),O=o(2),k="probe",_=(0,g.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:k}),D=(0,m.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:k});t.probe=_,t.probeTouch=D},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function l(e,t,o){var a=f.pixelToCanvas(e,t.handles.start),n=f.pixelToCanvas(e,t.handles.end),r={left:Math.min(a.x,n.x),top:Math.min(a.y,n.y),width:Math.abs(a.x-n.x),height:Math.abs(a.y-n.y)};return g.rect.distanceToPoint(r,o)<5}function i(e,t){for(var o=0,a=0,n=0,r=0,l=t.top;l<t.top+t.height;l++)for(var i=t.left;i<t.left+t.width;i++)o+=e[r],a+=e[r]*e[r],n++,r++;if(0===n)return{count:n,mean:0,variance:0,stdDev:0};var u=o/n,s=a/n-u*u;return{count:n,mean:u,variance:s,stdDev:Math.sqrt(s)}}function u(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function s(e,t){var o=(0,O.getToolState)(e.currentTarget,k);if(o){var a=t.image,n=t.element,r=y.default.getToolWidth(),l=_.getConfiguration(),s=t.canvasContext.canvas.getContext("2d"),d=f.metaData.get("generalSeriesModule",a.imageId),c=void 0;d&&(c=d.modality),s.setTransform(1,0,0,1,0,0);for(var v=0;v<o.data.length;v++){s.save();var m=o.data[v];l&&l.shadow&&(s.shadowColor=l.shadowColor||"#000000",s.shadowOffsetX=l.shadowOffsetX||1,s.shadowOffsetY=l.shadowOffsetY||1);var h=b.default.getColorIfActive(m.active),p=f.pixelToCanvas(n,m.handles.start),T=f.pixelToCanvas(n,m.handles.end),C=Math.min(p.x,T.x),M=Math.min(p.y,T.y),P=Math.abs(p.x-T.x),S=Math.abs(p.y-T.y);if(s.beginPath(),s.strokeStyle=h,s.lineWidth=r,s.rect(C,M,P,S),s.stroke(),l&&l.drawHandlesOnHover)if(!0===m.active)(0,x.default)(s,t,m.handles,h);else{var D={drawHandlesIfActive:!0};(0,x.default)(s,t,m.handles,h,D)}else(0,x.default)(s,t,m.handles,h);var j=void 0,E=void 0,R=void 0;if(!1===m.invalidated)E=m.meanStdDev,R=m.meanStdDevSUV,j=m.area;else{var A={left:Math.min(m.handles.start.x,m.handles.end.x),top:Math.min(m.handles.start.y,m.handles.end.y),width:Math.abs(m.handles.start.x-m.handles.end.x),height:Math.abs(m.handles.start.y-m.handles.end.y)};if(!a.color){E=i(f.getPixels(n,A.left,A.top,A.width,A.height),A),"PT"===c&&(R={mean:(0,I.default)(a,(E.mean-a.intercept)/a.slope),stdDev:(0,I.default)(a,(E.stdDev-a.intercept)/a.slope)}),E&&!isNaN(E.mean)&&(m.meanStdDev=E,m.meanStdDevSUV=R)}j=A.width*(a.columnPixelSpacing||1)*(A.height*(a.rowPixelSpacing||1)),isNaN(j)||(m.area=j),m.invalidated=!1}var B=[];if(E&&E.mean){var N="";"CT"===c&&(N=" HU");var H="Mean: "+u(E.mean.toFixed(2))+N,V="StdDev: "+u(E.stdDev.toFixed(2))+N;if(R&&void 0!==R.mean){H+=" SUV: "+u(R.mean.toFixed(2)),V+=" SUV: "+u(R.stdDev.toFixed(2))}B.push(H),B.push(V)}if(j){var W=" mm"+String.fromCharCode(178);a.rowPixelSpacing&&a.columnPixelSpacing||(W=" pixels"+String.fromCharCode(178));var L="Area: "+u(j.toFixed(2))+W;B.push(L)}m.handles.textBox.hasMoved||(m.handles.textBox.x=Math.max(m.handles.start.x,m.handles.end.x),m.handles.textBox.y=(m.handles.start.y+m.handles.end.y)/2);var Y=f.pixelToCanvas(n,m.handles.textBox),F={centering:{x:!1,y:!0}},z=(0,w.default)(s,B,Y.x,Y.y,h,F);if(m.handles.textBox.boundingBox=z,m.handles.textBox.hasMoved){var U={start:{},end:{x:Y.x,y:Y.y}},X=[{x:C+P/2,y:M},{x:C,y:M+S/2},{x:C+P/2,y:M+S},{x:C+P,y:M+S/2}];U.start=g.point.findClosestPoint(X,U.end);var q=[{x:z.left+z.width/2,y:z.top},{x:z.left,y:z.top+z.height/2},{x:z.left+z.width/2,y:z.top+z.height},{x:z.left+z.width,y:z.top+z.height/2}];U.end=g.point.findClosestPoint(q,U.start),s.beginPath(),s.strokeStyle=h,s.lineWidth=r,s.setLineDash([2,3]),s.moveTo(U.start.x,U.start.y),s.lineTo(U.end.x,U.end.y),s.stroke()}s.restore()}}}Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var d=o(0),f=n(d),c=o(3),g=n(c),v=o(8),m=a(v),h=o(10),p=a(h),T=o(6),y=a(T),C=o(5),b=a(C),M=o(9),x=a(M),P=o(7),w=a(P),S=o(18),I=a(S),O=o(2),k="rectangleRoi",_=(0,m.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:l,toolType:k}),D=(0,p.default)({createNewMeasurement:r,onImageRendered:s,pointNearTool:l,toolType:k});t.rectangleRoi=_,t.rectangleRoiTouch=D},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.element.getBoundingClientRect(e.element),o={x:e.currentPoints.client.x,y:e.currentPoints.client.y},a=e.element.clientWidth,n=e.element.clientHeight,r={x:o.x-t.left-a/2,y:-1*(o.y-t.top-n/2)},l=Math.atan2(r.y,r.x),i=l*(180/Math.PI),u=-1*i+90;e.viewport.rotation=u,g.setViewport(e.element,e.viewport)}function r(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,g.setViewport(e.element,e.viewport)}function l(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,g.setViewport(e.element,e.viewport)}function i(e,t){(0,f.default)(t.element).off("CornerstoneToolsMouseDrag",s),(0,f.default)(t.element).off("CornerstoneToolsMouseUp",i),(0,f.default)(t.element).off("CornerstoneToolsMouseClick",i)}function u(e,t){if((0,y.default)(t.which,e.data.mouseButtonMask))return(0,f.default)(t.element).on("CornerstoneToolsMouseDrag",s),(0,f.default)(t.element).on("CornerstoneToolsMouseUp",i),(0,f.default)(t.element).on("CornerstoneToolsMouseClick",i),!1}function s(e,t){return C.strategy(t),g.setViewport(t.element,t.viewport),!1}Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var d=o(1),f=a(d),c=o(0),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(c),v=o(14),m=a(v),h=o(12),p=a(h),T=o(4),y=a(T),C=(0,m.default)(u);C.strategies={default:n,horizontal:r,vertical:l},C.strategy=n;var b=(0,p.default)(s);t.rotate=C,t.rotateTouchDrag=b},function(e,t,o){"use strict";function a(e,t){return t.viewport.rotation+=t.rotation,s.setViewport(t.element,t.viewport),!1}function n(e){(0,i.default)(e).off("CornerstoneToolsTouchRotate",a)}function r(e){(0,i.default)(e).off("CornerstoneToolsTouchRotate",a),(0,i.default)(e).on("CornerstoneToolsTouchRotate",a)}Object.defineProperty(t,"__esModule",{value:!0});var l=o(1),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(u),d={activate:r,disable:n};t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=(0,n.default)(e).find("canvas").get(0),a=document.createElement("a");if(a.download=t,a.href=o.toDataURL(),document.createEvent){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(r)}else a.fireEvent&&a.fireEvent("onclick")};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){e(prompt("Enter your annotation:"))}function l(e,t,o){o(prompt("Change your annotation:"))}function i(e){function t(e){null===e?(0,z.removeToolState)(o,U,n):n.text=e,n.active=!1,p.updateImage(o)}var o=e.element,a=q.getConfiguration(),n=u(e);(0,z.addToolState)(o,U,n),p.updateImage(o),(0,A.default)(e,U,n,n.handles.end,function(){(0,E.default)(e,n.handles)&&(0,z.removeToolState)(o,U,n),void 0===n.text&&a.getTextCallback(t),p.updateImage(o)})}function u(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function s(e,t,o){if(t.handles.end){var a=p.pixelToCanvas(e,t.handles.end);return y.point.distance(a,o)<25}}function d(e,t){var o=(0,z.getToolState)(e.currentTarget,U);if(o){var a=t.enabledElement,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var r=t.canvasContext.canvas.width,l=void 0,i=k.default.getToolWidth(),u=I.default.getFont(),s=q.getConfiguration(),d=0;d<o.data.length;d++){n.save(),s&&s.shadow&&(n.shadowColor=s.shadowColor||"#000000",n.shadowOffsetX=s.shadowOffsetX||1,n.shadowOffsetY=s.shadowOffsetY||1);var f=o.data[d];l=f.active?D.default.getActiveColor():D.default.getToolColor();var c=p.pixelToCanvas(t.element,f.handles.end);(0,V.default)(n,c,l,i);var g={drawHandlesIfActive:s&&s.drawHandlesOnHover};if(s.drawHandles&&(0,N.default)(n,t,c,l,g),f.text&&""!==f.text){n.font=u;var v="";v=s.showCoordinates?f.text+" x: "+Math.round(f.handles.end.x)+" y: "+Math.round(f.handles.end.y):f.text;var m=n.measureText(v).width+10,h=I.default.getFontSize()+10,T=Math.max(m,h)/2+5;c.x>r/2&&(T=-T);var C=void 0;if(!f.handles.textBox.hasMoved){C={x:c.x-m/2+T,y:c.y-h/2};var b=p.internal.getTransform(a);b.invert();var M=b.transformPoint(C.x,C.y);f.handles.textBox.x=M.x,f.handles.textBox.y=M.y}C=p.pixelToCanvas(t.element,f.handles.textBox);var x=(0,w.default)(n,v,C.x,C.y,l);if(f.handles.textBox.boundingBox=x,f.handles.textBox.hasMoved){var P={start:{},end:{}};P.end.x=C.x,P.end.y=C.y,P.start=c;var S=[{x:x.left+x.width/2,y:x.top},{x:x.left,y:x.top+x.height/2},{x:x.left+x.width/2,y:x.top+x.height},{x:x.left+x.width,y:x.top+x.height/2}];P.end=y.point.findClosestPoint(S,P.start),n.beginPath(),n.strokeStyle=l,n.lineWidth=i,n.setLineDash([2,3]),n.moveTo(P.start.x,P.start.y),n.lineTo(P.end.x,P.end.y),n.stroke()}}n.restore()}}}function f(e){function t(e){null===e?(0,z.removeToolState)(o,U,n):n.text=e,n.active=!1,p.updateImage(o)}var o=e.element,a=q.getConfiguration(),n=u(e);(0,z.addToolState)(o,U,n),p.updateImage(o),(0,A.default)(e,U,n,n.handles.end,function(){(0,E.default)(e,n.handles)&&(0,z.removeToolState)(o,U,n),void 0===n.text&&a.getTextCallback(t),p.updateImage(o)})}function c(e,t){function o(e,t,o){!0===o?(0,z.removeToolState)(a,U,e):e.text=t,e.active=!1,p.updateImage(a)}var a=t.element,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,L.default)(t.which,e.data.mouseButtonMask)){var r=q.getConfiguration(),l=t.currentPoints.canvas,i=(0,z.getToolState)(a,U);if(i){for(var u=0;u<i.data.length;u++)if(n=i.data[u],s(a,n,l)||(0,F.default)(n.handles.textBox,l))return n.active=!0,p.updateImage(a),r.changeTextCallback(n,t,o),e.stopImmediatePropagation(),!1;return!1}}}function g(e,t){function o(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,z.removeToolState)(a,U,e):e.text=t,e.active=!1,p.updateImage(a),(0,m.default)(a).on("CornerstoneToolsTouchStart",K.touchStartCallback),(0,m.default)(a).on("CornerstoneToolsTouchStartActive",K.touchDownActivateCallback),(0,m.default)(a).on("CornerstoneToolsTap",K.tapCallback)}var a=t.element,n=void 0;if(e.data&&e.data.mouseButtonMask&&!(0,L.default)(t.which,e.data.mouseButtonMask))return!1;var r=q.getConfiguration(),l=t.currentPoints.canvas,i=(0,z.getToolState)(a,U);if(!i)return!1;if(t.handlePressed)return(0,m.default)(a).off("CornerstoneToolsTouchStart",K.touchStartCallback),(0,m.default)(a).off("CornerstoneToolsTouchStartActive",K.touchDownActivateCallback),(0,m.default)(a).off("CornerstoneToolsTap",K.tapCallback),r.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var u=0;u<i.data.length;u++)if(n=i.data[u],s(a,n,l)||(0,F.default)(n.handles.textBox,l))return n.active=!0,p.updateImage(a),(0,m.default)(a).off("CornerstoneToolsTouchStart",K.touchStartCallback),(0,m.default)(a).off("CornerstoneToolsTouchStartActive",K.touchDownActivateCallback),(0,m.default)(a).off("CornerstoneToolsTap",K.tapCallback),r.changeTextCallback(n,t,o),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var v=o(1),m=n(v),h=o(0),p=a(h),T=o(3),y=a(T),C=o(8),b=n(C),M=o(10),x=n(M),P=o(7),w=n(P),S=o(15),I=n(S),O=o(6),k=n(O),_=o(5),D=n(_),j=o(13),E=n(j),R=o(22),A=n(R),B=o(9),N=n(B),H=o(50),V=n(H),W=o(4),L=n(W),Y=o(19),F=n(Y),z=o(2),U="seedAnnotate",X={getTextCallback:r,changeTextCallback:l,drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0},q=(0,b.default)({addNewMeasurement:i,createNewMeasurement:u,onImageRendered:d,pointNearTool:s,toolType:U,mouseDoubleClickCallback:c});q.setConfiguration(X);var K=(0,x.default)({addNewMeasurement:f,createNewMeasurement:u,onImageRendered:d,pointNearTool:s,toolType:U,pressCallback:g});t.seedAnnotate=q,t.seedAnnotateTouch=K},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function l(e,t,o){var a={start:v.pixelToCanvas(e,t.handles.start),end:v.pixelToCanvas(e,t.handles.middle)},n=h.lineSegment.distanceToPoint(a,o);return n<25||(a.start=v.pixelToCanvas(e,t.handles.middle),a.end=v.pixelToCanvas(e,t.handles.end),(n=h.lineSegment.distanceToPoint(a,o))<25)}function i(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function u(e,t){var o=(0,V.getToolState)(e.currentTarget,W);if(o){var a=t.enabledElement,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var r=void 0,l=S.default.getToolWidth(),u=P.default.getFont(),s=L.getConfiguration(),d=0;d<o.data.length;d++){n.save(),s&&s.shadow&&(n.shadowColor=s.shadowColor||"#000000",n.shadowOffsetX=s.shadowOffsetX||1,n.shadowOffsetY=s.shadowOffsetY||1);var f=o.data[d];r=f.active?O.default.getActiveColor():O.default.getToolColor();var c=v.pixelToCanvas(t.element,f.handles.start),g=v.pixelToCanvas(t.element,f.handles.middle),m=v.pixelToCanvas(t.element,f.handles.end);n.beginPath(),n.strokeStyle=r,n.lineWidth=l,n.moveTo(c.x,c.y),n.lineTo(g.x,g.y),n.lineTo(m.x,m.y),n.stroke();var p={drawHandlesIfActive:s&&s.drawHandlesOnHover};(0,B.default)(n,t,f.handles,r,p),n.fillStyle=r;var T=t.image.columnPixelSpacing||1,y=t.image.rowPixelSpacing||1,b="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(b=" (isotropic)");var x={x:(Math.ceil(f.handles.middle.x)-Math.ceil(f.handles.start.x))*T,y:(Math.ceil(f.handles.middle.y)-Math.ceil(f.handles.start.y))*y},w={x:(Math.ceil(f.handles.end.x)-Math.ceil(f.handles.middle.x))*T,y:(Math.ceil(f.handles.end.y)-Math.ceil(f.handles.middle.y))*y},I={x:(Math.ceil(f.handles.end.x)-Math.ceil(f.handles.start.x))*T,y:(Math.ceil(f.handles.end.y)-Math.ceil(f.handles.start.y))*y},k=i(x),_=i(w),D=i(I),j=Math.acos((Math.pow(k,2)+Math.pow(_,2)-Math.pow(D,2))/(2*k*_));j*=180/Math.PI;var E=(0,M.default)(j,2);if(E){var R=E.toString()+String.fromCharCode(parseInt("00B0",16))+b,A=void 0;if(f.handles.textBox.hasMoved)A=v.pixelToCanvas(t.element,f.handles.textBox);else{A={x:g.x,y:g.y},n.font=u;var N=n.measureText(R).width;g.x<c.x?A.x-=15+N+10:A.x+=15;var H=v.internal.getTransform(a);H.invert();var Y=H.transformPoint(A.x,A.y);f.handles.textBox.x=Y.x,f.handles.textBox.y=Y.y}var F={centering:{x:!1,y:!0}},z=(0,C.default)(n,R,A.x,A.y,r,F);if(f.handles.textBox.boundingBox=z,f.handles.textBox.hasMoved){var U={start:{},end:{}},X=[c,m,g];U.end.x=A.x,U.end.y=A.y,U.start=h.point.findClosestPoint(X,U.end);var q=[{x:z.left+z.width/2,y:z.top},{x:z.left,y:z.top+z.height/2},{x:z.left+z.width/2,y:z.top+z.height},{x:z.left+z.width,y:z.top+z.height/2}];U.end=h.point.findClosestPoint(q,U.start),n.beginPath(),n.strokeStyle=r,n.lineWidth=l,n.setLineDash([2,3]),n.moveTo(U.start.x,U.start.y),n.lineTo(U.end.x,U.end.y),n.stroke()}}n.restore()}}}function s(e){var t=r(e),o=e.element,a={mouseButtonMask:e.which};(0,V.addToolState)(o,W,t),(0,c.default)(o).off("CornerstoneToolsMouseMove",L.mouseMoveCallback),(0,c.default)(o).off("CornerstoneToolsMouseDrag",L.mouseMoveCallback),(0,c.default)(o).off("CornerstoneToolsMouseDown",L.mouseDownCallback),(0,c.default)(o).off("CornerstoneToolsMouseDownActivate",L.mouseDownActivateCallback),v.updateImage(o),(0,j.default)(e,W,t,t.handles.middle,function(){if(t.active=!1,(0,_.default)(e,t.handles))return(0,V.removeToolState)(o,W,t),(0,c.default)(o).on("CornerstoneToolsMouseMove",L.mouseMoveCallback),(0,c.default)(o).on("CornerstoneToolsMouseDrag",L.mouseMoveCallback),(0,c.default)(o).on("CornerstoneToolsMouseDown",a,L.mouseDownCallback),(0,c.default)(o).on("CornerstoneToolsMouseDownActivate",a,L.mouseDownActivateCallback),void v.updateImage(o);t.handles.end.active=!0,v.updateImage(o),(0,j.default)(e,W,t,t.handles.end,function(){t.active=!1,(0,_.default)(e,t.handles)&&(0,V.removeToolState)(o,W,t),(0,c.default)(o).on("CornerstoneToolsMouseMove",L.mouseMoveCallback),(0,c.default)(o).on("CornerstoneToolsMouseDrag",L.mouseMoveCallback),(0,c.default)(o).on("CornerstoneToolsMouseDown",a,L.mouseDownCallback),(0,c.default)(o).on("CornerstoneToolsMouseDownActivate",a,L.mouseDownActivateCallback),v.updateImage(o)})})}function d(e){var t=r(e),o=e.element;(0,V.addToolState)(o,W,t),(0,c.default)(o).off("CornerstoneToolsTouchDrag",Y.touchMoveCallback),(0,c.default)(o).off("CornerstoneToolsTouchStartActive",Y.touchDownActivateCallback),(0,c.default)(o).off("CornerstoneToolsTouchStart",Y.touchStartCallback),(0,c.default)(o).off("CornerstoneToolsTap",Y.tapCallback),v.updateImage(o),(0,R.default)(e,W,t,t.handles.middle,function(){if((0,_.default)(e,t.handles))return(0,V.removeToolState)(o,W,t),(0,c.default)(o).on("CornerstoneToolsTouchDrag",Y.touchMoveCallback),(0,c.default)(o).on("CornerstoneToolsTouchStart",Y.touchStartCallback),(0,c.default)(o).on("CornerstoneToolsTouchStartActive",Y.touchDownActivateCallback),(0,c.default)(o).on("CornerstoneToolsTap",Y.tapCallback),void v.updateImage(o);(0,R.default)(e,W,t,t.handles.end,function(){(0,_.default)(e,t.handles)&&((0,V.removeToolState)(o,W,t),v.updateImage(o)),(0,c.default)(o).on("CornerstoneToolsTouchDrag",Y.touchMoveCallback),(0,c.default)(o).on("CornerstoneToolsTouchStart",Y.touchStartCallback),(0,c.default)(o).on("CornerstoneToolsTouchStartActive",Y.touchDownActivateCallback),(0,c.default)(o).on("CornerstoneToolsTap",Y.tapCallback)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var f=o(1),c=n(f),g=o(0),v=a(g),m=o(3),h=a(m),p=o(8),T=n(p),y=o(7),C=n(y),b=o(37),M=n(b),x=o(15),P=n(x),w=o(6),S=n(w),I=o(5),O=n(I),k=o(13),_=n(k),D=o(23),j=n(D),E=o(24),R=n(E),A=o(9),B=n(A),N=o(10),H=n(N),V=o(2),W="simpleAngle",L=(0,T.default)({createNewMeasurement:r,addNewMeasurement:s,onImageRendered:u,pointNearTool:l,toolType:W}),Y=(0,H.default)({createNewMeasurement:r,addNewMeasurement:d,onImageRendered:u,pointNearTool:l,toolType:W});t.simpleAngle=L,t.simpleAngleTouch=Y},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=_.getConfiguration();if(t.current){var o={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},a={left:0,top:0,width:e.image.width,height:e.image.height};if(m.point.insideRect(o.handles.end,a)){var n=t.markers.indexOf(t.current);return t.ascending?(n+=1)>=t.markers.length&&(t.loop?n-=t.markers.length:n=-1):(n-=1)<0&&(t.loop?n+=t.markers.length:n=-1),t.current=t.markers[n],o}}}function l(e,t,o){if(t.handles.end.boundingBox){var a=m.rect.distanceToPoint(t.handles.end.boundingBox,o),n=(0,b.default)(t.handles.end,o);return a<10||n}}function i(e,t){var o=(0,O.getToolState)(t.element,k);if(o){var a=t.canvasContext.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);for(var n=_.getConfiguration(),r=0;r<o.data.length;r++){var l=o.data[r],i=x.default.getToolColor();l.active&&(i=x.default.getActiveColor()),a.save(),n&&n.shadow&&(a.shadowColor=n.shadowColor||"#000000",a.shadowOffsetX=n.shadowOffsetX||1,a.shadowOffsetY=n.shadowOffsetY||1),a.fillStyle=i;var u=a.measureText(l.text);l.textWidth=u.width+10;var s=g.pixelToCanvas(t.element,l.handles.end),d={centering:{x:!0,y:!0}},f=(0,I.default)(a,l.text,s.x,s.y-10,i,d);l.handles.end.boundingBox=f,a.restore()}}}function u(e,t){function o(t,o,n){!0===n?(0,O.removeToolState)(a,k,t):t.text=o,t.active=!1,g.updateImage(a);var r={mouseButtonMask:e.data.mouseButtonMask};(0,f.default)(a).on("CornerstoneToolsMouseMove",r,_.mouseMoveCallback),(0,f.default)(a).on("CornerstoneToolsMouseDown",r,_.mouseDownCallback),(0,f.default)(a).on("CornerstoneToolsMouseDownActivate",r,_.mouseDownActivateCallback),(0,f.default)(a).on("CornerstoneToolsMouseDoubleClick",r,_.mouseDoubleClickCallback)}var a=t.element,n=void 0;if(!e.data||!e.data.mouseButtonMask||(0,w.default)(t.which,e.data.mouseButtonMask)){var r=_.getConfiguration(),i=t.currentPoints.canvas,u=(0,O.getToolState)(a,k);if(u){for(var s=0;s<u.data.length;s++)if(n=u.data[s],l(a,n,i))return n.active=!0,g.updateImage(a),(0,f.default)(a).off("CornerstoneToolsMouseMove",_.mouseMoveCallback),(0,f.default)(a).off("CornerstoneToolsMouseDown",_.mouseDownCallback),(0,f.default)(a).off("CornerstoneToolsMouseDownActivate",_.mouseDownActivateCallback),(0,f.default)(a).off("CornerstoneToolsMouseDoubleClick",_.mouseDoubleClickCallback),r.changeTextCallback(n,t,o),e.stopImmediatePropagation(),!1;return!1}}}function s(e,t){function o(e,t,o){!0===o?(0,O.removeToolState)(a,k,e):e.text=t,e.active=!1,g.updateImage(a),(0,f.default)(a).on("CornerstoneToolsTouchDrag",D.touchMoveCallback),(0,f.default)(a).on("CornerstoneToolsTouchStartActive",D.touchDownActivateCallback),(0,f.default)(a).on("CornerstoneToolsTouchStart",D.touchStartCallback),(0,f.default)(a).on("CornerstoneToolsTap",D.tapCallback),(0,f.default)(a).on("CornerstoneToolsTouchPress",D.pressCallback)}var a=t.element,n=void 0,r=_.getConfiguration(),i=t.currentPoints.canvas,u=(0,O.getToolState)(a,k);if(!u)return!1;if(t.handlePressed)return t.handlePressed.active=!0,g.updateImage(a),(0,f.default)(a).off("CornerstoneToolsTouchDrag",D.touchMoveCallback),(0,f.default)(a).off("CornerstoneToolsTouchStartActive",D.touchDownActivateCallback),(0,f.default)(a).off("CornerstoneToolsTouchStart",D.touchStartCallback),(0,f.default)(a).off("CornerstoneToolsTap",D.tapCallback),(0,f.default)(a).off("CornerstoneToolsTouchPress",D.pressCallback),r.changeTextCallback(t.handlePressed,t,o),e.stopImmediatePropagation(),!1;for(var s=0;s<u.data.length;s++)if(n=u.data[s],l(a,n,i))return n.active=!0,g.updateImage(a),(0,f.default)(a).off("CornerstoneToolsTouchDrag",D.touchMoveCallback),(0,f.default)(a).off("CornerstoneToolsTouchStartActive",D.touchDownActivateCallback),(0,f.default)(a).off("CornerstoneToolsTouchStart",D.touchStartCallback),(0,f.default)(a).off("CornerstoneToolsTap",D.tapCallback),(0,f.default)(a).off("CornerstoneToolsTouchPress",D.pressCallback),r.changeTextCallback(n,t,o),e.stopImmediatePropagation(),!1;return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var d=o(1),f=n(d),c=o(0),g=a(c),v=o(3),m=a(v),h=o(8),p=n(h),T=o(10),y=n(T),C=o(19),b=n(C),M=o(5),x=n(M),P=o(4),w=n(P),S=o(7),I=n(S),O=o(2),k="textMarker",_=(0,p.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:k,mouseDoubleClickCallback:u}),D=(0,y.default)({createNewMeasurement:r,onImageRendered:i,pointNearTool:l,toolType:k,pressCallback:s});t.textMarker=_,t.textMarkerTouch=D},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){(0,d.default)(t.element).off("CornerstoneToolsMouseDrag",i),(0,d.default)(t.element).off("CornerstoneToolsMouseUp",n),(0,d.default)(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,T.default)(t.which,e.data.mouseButtonMask))return(0,d.default)(t.element).on("CornerstoneToolsMouseDrag",i),(0,d.default)(t.element).on("CornerstoneToolsMouseUp",n),(0,d.default)(t.element).on("CornerstoneToolsMouseClick",n),!1}function l(e){var t=e.image.maxPixelValue*e.image.slope+e.image.intercept,o=e.image.minPixelValue*e.image.slope+e.image.intercept,a=t-o,n=a/1024,r=e.deltaPoints.page.x*n,l=e.deltaPoints.page.y*n;e.viewport.voi.windowWidth+=r,e.viewport.voi.windowCenter+=l}function i(e,t){return y.strategy(t),c.setViewport(t.element,t.viewport),!1}function u(e,t){e.stopImmediatePropagation();var o=t,a=o.image.maxPixelValue*o.image.slope+o.image.intercept,n=o.image.minPixelValue*o.image.slope+o.image.intercept,r=a-n,l=r/1024,i=o.deltaPoints.page.x*l,u=o.deltaPoints.page.y*l,s=y.getConfiguration();s.orientation?0===s.orientation?(o.viewport.voi.windowWidth+=i,o.viewport.voi.windowCenter+=u):(o.viewport.voi.windowWidth+=u,o.viewport.voi.windowCenter+=i):(o.viewport.voi.windowWidth+=i,o.viewport.voi.windowCenter+=u),c.setViewport(o.element,o.viewport)}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var s=o(1),d=a(s),f=o(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(f),g=o(14),v=a(g),m=o(12),h=a(m),p=o(4),T=a(p),y=(0,v.default)(r);y.strategies={default:l},y.strategy=l;var C=(0,h.default)(u);t.wwwc=y,t.wwwcTouchDrag=C},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){var a=e.length;if(a<2)return{min:t,max:o,mean:(t+o)/2};for(var n=o,r=t,l=0,i=0;i<a;i++){var u=e[i];n=Math.min(n,u),r=Math.max(r,u),l+=u}return{min:n,max:r,mean:l/a}}function r(e,t){var o=(0,I.getToolState)(t.element,j);o&&o.data&&(o.data=[]),(0,C.default)(t.element).off("CornerstoneToolsMouseMove",f),(0,C.default)(t.element).off("CornerstoneToolsMouseDrag",f),(0,C.default)(t.element).off("CornerstoneToolsMouseUp",l),(0,C.default)(t.element).off("CornerstoneToolsMouseClick",l);var a={mouseButtonMask:R};(0,C.default)(t.element).on("CornerstoneToolsMouseDown",a,s)}function l(e,t){(0,C.default)(t.element).off("CornerstoneToolsMouseMove",f),(0,C.default)(t.element).off("CornerstoneToolsMouseDrag",f),(0,C.default)(t.element).off("CornerstoneToolsMouseUp",l),(0,C.default)(t.element).off("CornerstoneToolsMouseClick",l);var o={mouseButtonMask:R};(0,C.default)(t.element).on("CornerstoneToolsMouseDown",o,s);var a=(0,I.getToolState)(t.element,j);a&&a.data&&a.data.length&&(a.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},i(t))}function i(e){var t=(0,I.getToolState)(e.element,j);if(t&&t.data&&t.data.length){var o=t.data[0].startPoint,a=t.data[0].endPoint,r=Math.abs(o.x-a.x),l=Math.abs(o.y-a.y),i=Math.min(o.x,a.x),u=Math.min(o.y,a.y);i=Math.max(i,0),i=Math.min(i,e.image.width),u=Math.max(u,0),u=Math.min(u,e.image.height),r=Math.floor(Math.min(r,Math.abs(e.image.width-i))),l=Math.floor(Math.min(l,Math.abs(e.image.height-u)));var s=(0,k.default)(e.element,i,u,r,l),d=n(s,e.image.minPixelValue,e.image.maxPixelValue),f=A.getConfiguration(),c=M.getViewport(e.element);void 0===f.minWindowWidth&&(f.minWindowWidth=10),c.voi.windowWidth=Math.max(Math.abs(d.max-d.min),f.minWindowWidth),c.voi.windowCenter=d.mean,M.setViewport(e.element,c),t.data=[],M.updateImage(e.element)}}function u(e,t){var o=t.element;(0,C.default)(o).off("CornerstoneToolsMouseMove"),(0,C.default)(o).off("CornerstoneToolsMouseDrag"),(0,C.default)(o).on("CornerstoneToolsMouseMove",f),(0,C.default)(o).on("CornerstoneToolsMouseDrag",f),(0,C.default)(o).on("CornerstoneToolsMouseClick",l),"CornerstoneToolsMouseDrag"===e.type&&(0,C.default)(o).on("CornerstoneToolsMouseUp",l)}function s(e,t){if((0,D.default)(t.which,e.data.mouseButtonMask))return(0,C.default)(t.element).on("CornerstoneToolsMouseDrag",t,u),(0,C.default)(t.element).on("CornerstoneToolsMouseMove",t,u),(0,C.default)(t.element).off("CornerstoneToolsMouseDown",s),d(t),!1}function d(e){var t=(0,I.getToolState)(e.element,j);t&&t.data&&(t.data=[]);var o={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,I.addToolState)(e.element,j,o)}function f(e,t){var o=(0,I.getToolState)(t.element,j);if(o&&o.data&&o.data.length){var a={x:t.currentPoints.image.x,y:t.currentPoints.image.y};o.data[0].endPoint=a,M.updateImage(t.element)}}function c(e,t){var o=(0,I.getToolState)(t.element,j);if(o&&o.data&&o.data.length){var a=o.data[0].startPoint,n=o.data[0].endPoint;if(a&&n){var r=(0,C.default)(t.element).find("canvas").get(0),l=r.getContext("2d");l.setTransform(1,0,0,1,0,0);var i=S.default.getActiveColor(),u=M.pixelToCanvas(t.element,a),s=M.pixelToCanvas(t.element,n),d=Math.min(u.x,s.x),f=Math.min(u.y,s.y),c=Math.abs(u.x-s.x),g=Math.abs(u.y-s.y),v=P.default.getToolWidth(),m=A.getConfiguration();l.save(),m&&m.shadow&&(l.shadowColor=m.shadowColor||"#000000",l.shadowOffsetX=m.shadowOffsetX||1,l.shadowOffsetY=m.shadowOffsetY||1),l.beginPath(),l.strokeStyle=i,l.lineWidth=v,l.rect(d,f,c,g),l.stroke(),l.restore()}}}function g(e){(0,C.default)(e).off("CornerstoneToolsMouseDown",s),(0,C.default)(e).off("CornerstoneToolsMouseUp",l),(0,C.default)(e).off("CornerstoneToolsMouseClick",l),(0,C.default)(e).off("CornerstoneToolsMouseDrag",f),(0,C.default)(e).off("CornerstoneToolsMouseMove",f),(0,C.default)(e).off("CornerstoneImageRendered",c),(0,C.default)(e).off("CornerstoneNewImage",r),M.updateImage(e)}function v(e,t){var o={mouseButtonMask:t};if(R=t,!(0,I.getToolState)(e,j)){var a=[];(0,I.addToolState)(e,j,a)}(0,C.default)(e).off("CornerstoneToolsMouseDown",s),(0,C.default)(e).off("CornerstoneToolsMouseUp",l),(0,C.default)(e).off("CornerstoneToolsMouseClick",l),(0,C.default)(e).off("CornerstoneToolsMouseDrag",f),(0,C.default)(e).off("CornerstoneToolsMouseMove",f),(0,C.default)(e).off("CornerstoneImageRendered",c),(0,C.default)(e).off("CornerstoneNewImage",r),(0,C.default)(e).on("CornerstoneToolsMouseDown",o,s),(0,C.default)(e).on("CornerstoneImageRendered",c),(0,C.default)(e).on("CornerstoneNewImage",r),M.updateImage(e)}function m(e){(0,C.default)(e).off("CornerstoneToolsTouchDrag",f),(0,C.default)(e).off("CornerstoneToolsTouchStart",d),(0,C.default)(e).off("CornerstoneToolsDragEnd",i),(0,C.default)(e).off("CornerstoneImageRendered",c)}function h(e){if(!(0,I.getToolState)(e,j)){var t=[];(0,I.addToolState)(e,j,t)}(0,C.default)(e).off("CornerstoneToolsTouchDrag",f),(0,C.default)(e).off("CornerstoneToolsTouchStart",d),(0,C.default)(e).off("CornerstoneToolsDragEnd",i),(0,C.default)(e).off("CornerstoneImageRendered",c),(0,C.default)(e).on("CornerstoneToolsTouchDrag",f),(0,C.default)(e).on("CornerstoneToolsTouchStart",d),(0,C.default)(e).on("CornerstoneToolsDragEnd",i),(0,C.default)(e).on("CornerstoneImageRendered",c)}function p(){return E}function T(e){E=e}Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var y=o(1),C=a(y),b=o(0),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(b),x=o(6),P=a(x),w=o(5),S=a(w),I=o(2),O=o(52),k=a(O),_=o(4),D=a(_),j="wwwcRegion",E={minWindowWidth:10},R=void 0,A={activate:v,deactivate:g,disable:g,setConfiguration:T,getConfiguration:p},B={activate:h,deactivate:m,disable:m};t.wwwcRegion=A,t.wwwcRegionTouch=B},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=_.getConfiguration(),a=Math.log(e.scale)/Math.log(1.7),n=a+t,r=Math.pow(1.7,n);return o.maxScale&&r>o.maxScale?e.scale=o.maxScale:o.minScale&&r<o.minScale?e.scale=o.minScale:e.scale=r,e}function r(e,t,o){return e.x=Math.max(e.x,0),e.y=Math.max(e.y,0),e.x=Math.min(e.x,t),e.y=Math.min(e.y,o),e}function l(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var o=t.rotation*Math.PI/180,a=Math.cos(o),n=Math.sin(o),r=e.x*a-e.y*n,l=e.x*n+e.y*a;e.x=r,e.y=l}return e}function i(e,t){var o=e.element,a=n(e.viewport,t);T.setViewport(o,a);var r=T.pageToPixel(o,e.startPoints.page.x,e.startPoints.page.y),i={x:e.startPoints.image.x-r.x,y:e.startPoints.image.y-r.y};i=l(i,a),a.translation.x-=i.x,a.translation.y-=i.y,T.setViewport(o,a)}function u(e,t){var o=e.element,a=e.image,i=_.getConfiguration(),u=n(e.viewport,t),s={x:0,y:0};if(t<0)u.scale<3&&(Math.abs(u.translation.x)<.01?u.translation.x=0:s.x=u.translation.x/8,Math.abs(u.translation.y)<.01?u.translation.y=0:s.y=u.translation.y/8);else{i&&i.preventZoomOutsideImage&&(k.image=r(k.image,a.width,a.height));var d={x:a.width/2-k.image.x,y:a.height/2-k.image.y};d=l(d,u);var f={x:u.translation.x-d.x,y:u.translation.y-d.y};Math.abs(f.x)<.01?u.translation.x=d.x:s.x=f.x/8,Math.abs(f.y)<.01?u.translation.y=d.y:s.y=f.y/8}u.translation.x-=s.x,u.translation.y-=s.y,T.setViewport(o,u)}function s(e,t){var o=e.element,a=n(e.viewport,t);T.setViewport(o,a)}function d(e,t){(0,h.default)(t.element).off("CornerstoneToolsMouseDrag",c),(0,h.default)(t.element).off("CornerstoneToolsMouseUp",d),(0,h.default)(t.element).off("CornerstoneToolsMouseClick",d)}function f(e,t){if((0,M.default)(t.which,e.data.mouseButtonMask))return k=t.startPoints,(0,h.default)(t.element).on("CornerstoneToolsMouseDrag",c),(0,h.default)(t.element).on("CornerstoneToolsMouseUp",d),(0,h.default)(t.element).on("CornerstoneToolsMouseClick",d),!1}function c(e,t){if(!t.deltaPoints.page.y)return!1;var o=t.deltaPoints.page.y/100;return _.strategy(t,o),!1}function g(e,t){var o=-t.direction/4,a=_.getConfiguration();a&&a.invert&&(o*=-1);var r=n(t.viewport,o);T.setViewport(t.element,r)}function v(e,t){var o=_.getConfiguration(),a=t.viewport,n=t.element;a.scale+=t.scaleChange*a.scale,o.maxScale&&a.scale>o.maxScale?a.scale=o.maxScale:o.minScale&&a.scale<o.minScale&&(a.scale=o.minScale),T.setViewport(n,a);var r=T.pageToPixel(n,t.startPoints.page.x,t.startPoints.page.y),i={x:t.startPoints.image.x-r.x,y:t.startPoints.image.y-r.y};i=l(i,a),a.translation.x-=i.x,a.translation.y-=i.y,T.setViewport(n,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var m=o(1),h=a(m),p=o(0),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(p),y=o(14),C=a(y),b=o(4),M=a(b),x=o(21),P=a(x),w=o(42),S=a(w),I=o(12),O=a(I),k=void 0,_=(0,C.default)(f);_.strategies={default:i,translate:u,zoomToCenter:s},_.strategy=i;var D=(0,P.default)(g),j=(0,S.default)(v),E=(0,O.default)(c);t.zoom=_,t.zoomWheel=D,t.zoomTouchPinch=j,t.zoomTouchDrag=E},function(e,t,o){"use strict";function a(e){var t=e.currentTarget,o={event:window.event||e,element:t,viewport:d.getViewport(t),image:d.getEnabledElement(t).image,currentPoints:{page:{x:f,y:c},image:d.pageToPixel(t,f,c)},keyCode:e.keyCode,which:e.which};o.currentPoints.canvas=d.pixelToCanvas(t,o.currentPoints.image);var a={keydown:"CornerstoneToolsKeyDown",keypress:"CornerstoneToolsKeyPress",keyup:"CornerstoneToolsKeyUp"};(0,u.default)(t).trigger(a[e.type],o)}function n(e){f=e.pageX||e.originalEvent.pageX,c=e.pageY||e.originalEvent.pageY}function r(e){l(e),(0,u.default)(e).on(g,a),(0,u.default)(e).on("mousemove",n)}function l(e){(0,u.default)(e).off(g,a),(0,u.default)(e).off("mousemove",n)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(1),u=function(e){return e&&e.__esModule?e:{default:e}}(i),s=o(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(s),f=void 0,c=void 0,g="keydown keypress keyup",v={enable:r,disable:l};t.default=v},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return"number"!=typeof e.buttons?e.which:0===e.buttons?0:e.buttons%2==1?1:e.buttons%4==2?3:e.buttons%8==4?2:0}function l(){x=!1}function i(e){(0,v.default)(e.element).trigger("CornerstoneToolsMouseDownActivate",e)}function u(e){var t=e.currentTarget,o="CornerstoneToolsMouseDoubleClick",a={page:T.point.pageToPoint(e),image:h.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};a.canvas=h.pixelToCanvas(t,a.image);var n=(0,C.default)(a),l={event:e,which:r(e),viewport:h.getViewport(t),image:h.getEnabledElement(t).image,element:t,startPoints:a,lastPoints:n,currentPoints:a,deltaPoints:{x:0,y:0},type:o},i=v.default.Event(o,l);(0,v.default)(l.element).trigger(i,l)}function s(e){function t(e){var t={page:T.point.pageToPoint(e),image:h.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};t.canvas=h.pixelToCanvas(a,t.image);var o={page:T.point.subtract(t.page,u.page),image:T.point.subtract(t.image,u.image),client:T.point.subtract(t.client,u.client),canvas:T.point.subtract(t.canvas,u.canvas)},r={which:c,viewport:h.getViewport(a),image:h.getEnabledElement(a).image,element:a,startPoints:n,lastPoints:u,currentPoints:t,deltaPoints:o,type:"CornerstoneToolsMouseDrag",ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};return(0,v.default)(r.element).trigger("CornerstoneToolsMouseDrag",r),u=(0,C.default)(t),(0,M.default)(e)}function o(e){clearTimeout(P);var r="CornerstoneToolsMouseUp";x&&(r="CornerstoneToolsMouseClick");var l={page:T.point.pageToPoint(e),image:h.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=h.pixelToCanvas(a,l.image);var i={page:T.point.subtract(l.page,u.page),image:T.point.subtract(l.image,u.image),client:T.point.subtract(l.client,u.client),canvas:T.point.subtract(l.canvas,u.canvas)},s={event:e,which:c,viewport:h.getViewport(a),image:h.getEnabledElement(a).image,element:a,startPoints:n,lastPoints:u,currentPoints:l,deltaPoints:i,type:r},f=v.default.Event(r,s);(0,v.default)(s.element).trigger(f,s),(0,v.default)(document).off("mousemove",t),(0,v.default)(document).off("mouseup",o),(0,v.default)(s.element).on("mousemove",d),x=!0}P=setTimeout(l,w);var a=e.currentTarget;(0,v.default)(a).off("mousemove",d);var n={page:T.point.pageToPoint(e),image:h.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};n.canvas=h.pixelToCanvas(a,n.image);var u=(0,C.default)(n),s={event:e,which:r(e),viewport:h.getViewport(a),image:h.getEnabledElement(a).image,element:a,startPoints:n,lastPoints:u,currentPoints:n,deltaPoints:{x:0,y:0},type:"CornerstoneToolsMouseDown"},f=v.default.Event("CornerstoneToolsMouseDown",s);if((0,v.default)(s.element).trigger(f,s),!1===f.isImmediatePropagationStopped()&&!0===i(s))return(0,M.default)(e);var c=r(e);return(0,v.default)(document).on("mousemove",t),(0,v.default)(document).on("mouseup",o),(0,M.default)(e)}function d(e){var t=e.currentTarget,o={page:T.point.pageToPoint(e),image:h.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};o.canvas=h.pixelToCanvas(t,o.image);var a=(0,C.default)(o),n=r(e),l={page:T.point.pageToPoint(e),image:h.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=h.pixelToCanvas(t,l.image);var i={page:T.point.subtract(l.page,a.page),image:T.point.subtract(l.image,a.image),client:T.point.subtract(l.client,a.client),canvas:T.point.subtract(l.canvas,a.canvas)},u={which:n,viewport:h.getViewport(t),image:h.getEnabledElement(t).image,element:t,startPoints:o,lastPoints:a,currentPoints:l,deltaPoints:i,type:"CornerstoneToolsMouseMove"};(0,v.default)(t).trigger("CornerstoneToolsMouseMove",u),a=(0,C.default)(l)}function f(e){(0,v.default)(e).off("mousedown",s),(0,v.default)(e).off("mousemove",d),(0,v.default)(e).off("dblclick",u)}function c(e){f(e),(0,v.default)(e).on("mousedown",s),(0,v.default)(e).on("mousemove",d),(0,v.default)(e).on("dblclick",u)}Object.defineProperty(t,"__esModule",{value:!0});var g=o(1),v=n(g),m=o(0),h=a(m),p=o(3),T=a(p),y=o(32),C=n(y),b=o(34),M=n(b),x=!0,P=void 0,w=200,S={enable:c,disable:f};t.default=S},function(e,t,o){"use strict";function a(e){if(!("mousewheel"===e.originalEvent.type&&0===e.originalEvent.wheelDeltaY||"DOMMouseScroll"===e.originalEvent.type&&1===e.originalEvent.axis)){e.preventDefault();var t=e.currentTarget,o=void 0,a=void 0;void 0!==e.pageX&&void 0!==e.pageY?(o=e.pageX,a=e.pageY):e.originalEvent&&void 0!==e.originalEvent.pageX&&void 0!==e.originalEvent.pageY?(o=e.originalEvent.pageX,a=e.originalEvent.pageY):(o=e.x,a=e.y);var n=s.pageToPixel(t,o,a);e=window.event||e;var r=void 0;r=e.originalEvent&&e.originalEvent.wheelDelta?-e.originalEvent.wheelDelta:e.originalEvent&&e.originalEvent.deltaY?-e.originalEvent.deltaY:e.originalEvent&&e.originalEvent.detail?-e.originalEvent.detail:e.wheelDelta;var l=r<0?-1:1,u={element:t,viewport:s.getViewport(t),image:s.getEnabledElement(t).image,direction:l,pageX:o,pageY:a,imageX:n.x,imageY:n.y};(0,i.default)(t).trigger("CornerstoneToolsMouseWheel",u)}}function n(e){r(e),(0,i.default)(e).on(d,a)}function r(e){(0,i.default)(e).unbind(d,a)}Object.defineProperty(t,"__esModule",{value:!0});var l=o(1),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u=o(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(u),d="mousewheel DOMMouseScroll",f={enable:n,disable:r};t.default=f},function(e,t,o){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.currentTarget||e.srcEvent.currentTarget,o=void 0,a=void 0,n=void 0,r=void 0,l=void 0,i=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>1)&&(E=!1,clearTimeout(O)),e.type){case"tap":E=!1,clearTimeout(O),x={page:m.point.pageToPoint(e.pointers[0]),image:g.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=g.pixelToCanvas(t,x.image),a="CornerstoneToolsTap",S={event:e,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,currentPoints:x,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S);break;case"doubletap":E=!1,clearTimeout(O),x={page:m.point.pageToPoint(e.pointers[0]),image:g.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=g.pixelToCanvas(t,x.image),a="CornerstoneToolsDoubleTap",S={event:e,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,currentPoints:x,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S);break;case"pinchstart":E=!1,clearTimeout(O),_=1;break;case"pinchmove":if(E=!1,clearTimeout(O),!0===j){_=e.scale,j=!1;break}n=(e.scale-_)/_,M={page:e.center,image:g.pageToPixel(t,e.center.x,e.center.y)},M.canvas=g.pixelToCanvas(t,M.image),a="CornerstoneToolsTouchPinch",S={event:e,startPoints:M,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,direction:e.scale<1?1:-1,scaleChange:n,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S),_=e.scale;break;case"touchstart":_=1,clearTimeout(O),clearTimeout(I),I=setTimeout(function(){M={page:m.point.pageToPoint(e.originalEvent.touches[0]),image:g.pageToPixel(t,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},M.canvas=g.pixelToCanvas(t,M.image),a="CornerstoneToolsTouchStart",e.originalEvent.touches.length>1&&(a="CornerstoneToolsMultiTouchStart"),S={event:e,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,startPoints:M,currentPoints:M,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S),!1===o.isImmediatePropagationStopped()&&(a="CornerstoneToolsTouchStartActive",e.originalEvent.touches.length>1&&(a="CornerstoneToolsMultiTouchStartActive"),S.type=a,(0,s.default)(t).trigger(a,S)),P=(0,p.default)(M)},50),E=!0,k=0,O=setTimeout(function(){E&&(x={page:m.point.pageToPoint(e.originalEvent.touches[0]),image:g.pageToPixel(t,e.originalEvent.touches[0].pageX,e.originalEvent.touches[0].pageY),client:{x:e.originalEvent.touches[0].clientX,y:e.originalEvent.touches[0].clientY}},x.canvas=g.pixelToCanvas(t,M.image),a="CornerstoneToolsTouchPress",S={event:e,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,currentPoints:x,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S))},A);break;case"touchend":_=1,E=!1,clearTimeout(O),setTimeout(function(){M={page:m.point.pageToPoint(e.originalEvent.changedTouches[0]),image:g.pageToPixel(t,e.originalEvent.changedTouches[0].pageX,e.originalEvent.changedTouches[0].pageY),client:{x:e.originalEvent.changedTouches[0].clientX,y:e.originalEvent.changedTouches[0].clientY}},M.canvas=g.pixelToCanvas(t,M.image),a="CornerstoneToolsTouchEnd",S={event:e,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,startPoints:M,currentPoints:M,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S)},50);break;case"panmove":r={x:e.deltaX-R.x,y:e.deltaY-R.y},R={x:e.deltaX,y:e.deltaY},x={page:{x:P.page.x+r.x,y:P.page.y+r.y},image:g.pageToPixel(t,P.page.x+r.x,P.page.y+r.y),client:{x:P.client.x+r.x,y:P.client.y+r.y}},x.canvas=g.pixelToCanvas(t,x.image),w={page:m.point.subtract(x.page,P.page),image:m.point.subtract(x.image,P.image),client:m.point.subtract(x.client,P.client),canvas:m.point.subtract(x.canvas,P.canvas)},k+=Math.sqrt(w.page.x*w.page.x+w.page.y*w.page.y),k>B&&(E=!1,clearTimeout(O)),a="CornerstoneToolsTouchDrag",e.pointers.length>1&&(a="CornerstoneToolsMultiTouchDrag"),S={viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,startPoints:M,lastPoints:P,currentPoints:x,deltaPoints:w,numPointers:e.pointers.length,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S),P=(0,p.default)(x);break;case"panstart":R={x:e.deltaX,y:e.deltaY},x={page:m.point.pageToPoint(e.pointers[0]),image:g.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=g.pixelToCanvas(t,x.image),P=(0,p.default)(x);break;case"panend":return E=!1,(clearTimeout(O),P)?(x={page:m.point.pageToPoint(e.pointers[0]),image:g.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}},x.canvas=g.pixelToCanvas(t,x.image),w={page:m.point.subtract(x.page,P.page),image:m.point.subtract(x.image,P.image),client:m.point.subtract(x.client,P.client),canvas:m.point.subtract(x.canvas,P.canvas)},a="CornerstoneToolsDragEnd",S={event:e.srcEvent,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,startPoints:M,lastPoints:P,currentPoints:x,deltaPoints:w,type:a,isTouchEvent:!0},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S),l=e.pointers.length-e.changedPointers.length,2===l&&(j=!0),(0,y.default)(e)):!1;case"rotatemove":E=!1,clearTimeout(O),i=e.rotation-D,D=e.rotation,a="CornerstoneToolsTouchRotate",S={event:e.srcEvent,viewport:g.getViewport(t),image:g.getEnabledElement(t).image,element:t,rotation:i,type:a},o=s.default.Event(a,S),(0,s.default)(t).trigger(o,S)}return!1}function l(e){i(e);var t={inputClass:f.default.SUPPORT_POINTER_EVENTS?f.default.PointerEventInput:f.default.TouchInput},o=new f.default.Manager(e,t),a={pointers:0,direction:f.default.DIRECTION_ALL,threshold:0},n=new f.default.Pan(a),l=new f.default.Pinch({threshold:0}),u=new f.default.Rotate({threshold:0});l.recognizeWith(n),l.recognizeWith(u),u.recognizeWith(n);var d=new f.default.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});d.recognizeWith(n),o.add([d,n,u,l]),o.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",r),b.default.enable(e),(0,s.default)(e).on("touchstart touchend",r),(0,s.default)(e).data("hammer",o)}function i(e){b.default.disable(e),(0,s.default)(e).off("touchstart touchend",r);var t=(0,s.default)(e).data("hammer");t&&t.off("tap doubletap panstart panmove panend pinchmove rotatemove",r)}Object.defineProperty(t,"__esModule",{value:!0});var u=o(1),s=n(u),d=o(110),f=n(d),c=o(0),g=a(c),v=o(3),m=a(v),h=o(32),p=n(h),T=o(34),y=n(T),C=o(43),b=n(C),M=void 0,x=void 0,P=void 0,w=void 0,S=void 0,I=void 0,O=void 0,k=void 0,_=1,D=0,j=!1,E=!1,R=void 0,A=700,B=5,N={enable:l,disable:i};t.default=N},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),r=n.metaData;t.default=r},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return{visible:!0,active:!0,handles:{imageData:e}}}function r(e){var t=D.getConfiguration(),o=y.getEnabledElement(e.element),a=o.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0),l(a,e.currentPoints.canvas,t.radius*o.viewport.scale,t.dragColor),O.push({x:Math.round(e.currentPoints.image.x),y:Math.round(e.currentPoints.image.y)}),k=e.currentPoints.canvas}function l(e,t,o,a){e.save(),e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI,!0),e.strokeStyle=a,e.fillStyle=a,e.stroke(),e.fill(),e.restore()}function i(e,t,o){e.save(),e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI,!0),e.clip(),e.clearRect(t.x-o-1,t.y-o-1,2*o+2,2*o+2),e.restore()}function u(e){var t=S[e.currentTarget.id],o=t.getContext("2d"),a=t.width,n=t.height;o.save(),o.setTransform(1,0,0,1,0,0),o.beginPath(),o.clearRect(0,0,a,n),o.restore();var r=(0,C.getToolState)(e.currentTarget,w);if(r){var l=r.data[r.data.length-1];o.putImageData(l.handles.imageData,0,0)}y.updateImage(e.currentTarget,!0)}function s(e,t){k=t.currentPoints.canvas,y.updateImage(t.element)}function d(e,t){k=t.currentPoints.canvas,y.updateImage(t.element,!0),(0,p.default)(t.element).off("CornerstoneToolsMouseDrag",s),(0,p.default)(t.element).off("CornerstoneToolsMouseDrag",f),(0,p.default)(t.element).off("CornerstoneToolsMouseUp",d),(0,p.default)(t.element).off("CornerstoneToolsMouseClick",d)}function f(e,t){return D.strategy(t),!1}function c(e,t){if((0,P.default)(t.which,e.data.mouseButtonMask))return(0,p.default)(t.element).on("CornerstoneToolsMouseDrag",f),(0,p.default)(t.element).on("CornerstoneToolsMouseUp",d),(0,p.default)(t.element).on("CornerstoneToolsMouseClick",d),D.strategy(t),!1;(0,p.default)(t.element).on("CornerstoneToolsMouseDrag",s),(0,p.default)(t.element).on("CornerstoneToolsMouseUp",d)}function g(e,t){var o=D.getConfiguration(),a=y.getEnabledElement(t.element),n=a.canvas.getContext("2d");if(n.setTransform(1,0,0,1,0,0),k){var r=o.radius*a.viewport.scale;l(n,k,r,o.hoverColor)}}function v(e,t){return function(){var o=D.getConfiguration(),a=o.draw,r=o.radius,u=o.overlayColor,s=t.width,d=t.height,f=t.getContext("2d");1===a?O.forEach(function(e){l(f,e,r,u)}):O.forEach(function(e){i(f,e,r)}),O=[];var c=f.getImageData(0,0,s,d),g=n(c);return(0,C.addToolState)(e,w,g),c.data}}function m(e,t){(0,p.default)(e).off("CornerstoneImageRendered",g),(0,p.default)(e).on("CornerstoneImageRendered",g);var o={mouseButtonMask:t};(0,p.default)(e).off("CornerstoneToolsMouseDownActivate",c),(0,p.default)(e).on("CornerstoneToolsMouseDownActivate",o,c),(0,p.default)(e).off("CornerstoneToolsMouseMove",s),(0,p.default)(e).on("CornerstoneToolsMouseMove",s),(0,p.default)(e).off("CornerstoneStackScroll",u),(0,p.default)(e).on("CornerstoneStackScroll",u);var a=y.getEnabledElement(e),n=document.createElement("canvas");n.width=a.image.width,n.height=a.image.height;var r=n.getContext("2d"),l=n.width,i=n.height;r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,l,i);var d={minPixelValue:0,maxPixelValue:255,slope:1,intercept:0,windowCenter:127,windowWidth:256,getPixelData:v(e,n),rgba:!0,rows:a.image.height,columns:a.image.width,height:a.image.height,width:a.image.width,color:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:a.image.width*a.image.height*4},f=void 0;_&&(f=y.getLayer(e,_)),f||(_=y.addLayer(e,d)),S[e.id]=n,y.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var h=o(1),p=a(h),T=o(0),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(T),C=o(2),b=o(8),M=a(b),x=o(4),P=a(x),w="brush",S={},I={draw:1,radius:10,hoverColor:"green",dragColor:"yellow",overlayColor:"red"},O=[],k=void 0,_=void 0,D=(0,M.default)({mouseMoveCallback:s,mouseDownActivateCallback:c,onImageRendered:g});D.activate=m,D.setConfiguration(I),D.strategies={default:r},D.strategy=r,t.brush=D},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(55),r=a(n),l=o(116),i=a(l),u=o(56),s=a(u),d={calculateReferenceLine:r.default,tool:i.default,renderActiveReferenceLine:s.default};t.default=d},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=void 0,a=void 0,n=void 0,r=0,l=e.length,i=[];for(i.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),o=1;o<l;o++)n=Number(e[o])/t|0,i.push(n),1===o?a=n:n!==a&&(i.isTimeVarying=!0),r+=n;return i.length>0&&(n=i.isTimeVarying?r/i.length|0:i[0],i.push(n)),i}function r(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function l(e){var t={element:e},o=d.default.Event("CornerstoneToolsClipStopped",t);(0,d.default)(e).trigger(o,t)}function i(e,t){var o=void 0,a=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var i=(0,m.getToolState)(e,"stack");if(i&&i.data&&i.data.length){var u=void 0;if(i.data.length>1){var s=(0,m.getToolState)(e,"stackRenderer");s&&s.data&&s.data.length&&(u=s.data[0])}var d=i.data[0],f=(0,m.getToolState)(e,h);f&&f.data&&f.data.length?(o=f.data[0],r(o)):(o={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,m.addToolState)(e,h,o)),(t<0||t>0)&&(o.framesPerSecond=Number(t),o.reverse=o.framesPerSecond<0,o.ignoreFrameTimeVector=!0),!0!==o.ignoreFrameTimeVector&&o.frameTimeVector&&o.frameTimeVector.length===d.imageIds.length&&(a=n(o.frameTimeVector,o.speed));var g=function(){var t=void 0,a=void 0,n=void 0,s=void 0,f=void 0,g=d.currentImageIdIndex,m=d.imageIds.length;if(o.reverse?g--:g++,!o.loop&&(g<0||g>=m))return r(o),void l(e);g>=m&&(g=0),g<0&&(g=m-1),g!==d.currentImageIdIndex&&(n=v.default.getStartLoadHandler(),s=v.default.getEndLoadHandler(),f=v.default.getErrorLoadingHandler(),n&&n(e),a=c.getViewport(e),t=!0===d.preventCache?c.loadImage(d.imageIds[g]):c.loadAndCacheImage(d.imageIds[g]),t.then(function(t){try{d.currentImageIdIndex=g,u?(u.currentImageIdIndex=g,u.render(e,i.data,a)):c.displayImage(e,t,a),s&&s(e,t)}catch(e){return}},function(t){var o=d.imageIds[g];f&&f(e,o,t)}))};a&&a.length>0&&a.isTimeVarying?(o.usingFrameTimeVector=!0,o.intervalId=setTimeout(function e(){o.intervalId=setTimeout(e,a[d.currentImageIdIndex]),g()},0)):(o.usingFrameTimeVector=!1,o.intervalId=setInterval(g,1e3/Math.abs(o.framesPerSecond)))}}function u(e){var t=(0,m.getToolState)(e,h);t&&t.data&&t.data.length&&r(t.data[0])}Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var s=o(1),d=a(s),f=o(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(f),g=o(11),v=a(g),m=o(2),h="playClip";t.playClip=i,t.stopClip=u},function(e,t,o){"use strict";function a(e,t){var o=t.element,a=t.enabledElement.canvas.width,n=t.enabledElement.canvas.height;if(!a||!n)return!1;var r=t.enabledElement.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.save();var u=s.getConfiguration();r.fillStyle=u.backgroundColor,"horizontal"===u.orientation?r.fillRect(0,n-i,a,i):r.fillRect(0,0,i,n);var d=(0,l.getToolState)(o,"stack");if(d&&d.data&&d.data.length){var f=d.data[0].imageIds,c=d.data[0].currentImageIdIndex,g=a/f.length,v=n/f.length,m=g*c,h=v*c;r.fillStyle=u.fillColor,"horizontal"===u.orientation?r.fillRect(m,n-i,g,i):r.fillRect(0,h,i,v),r.restore()}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(20),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=o(2),i=6,u={backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"},s=(0,r.default)(a);s.setConfiguration(u),t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){e=Math.round(e)||0,t=Math.round(t)||0;var o=[],a=t-e+1;if(a<=0)return o;for(;a--;)o[a]=t--;return o}function r(e,t){var o=[],a=[];return e.forEach(function(e){e<t?o.push(e):e>t&&a.push(e)}),{low:e.indexOf(O(o)),high:e.indexOf(k(a))}}function l(e){function t(e){var t=u.indicesToRequest.indexOf(e);t>-1&&u.indicesToRequest.splice(t,1)}function o(e){t(l.imageIds.indexOf(e.imageId))}function a(t){console.log("prefetch errored: "+t),c&&c(e,d,t,"stackPrefetch")}var n=(0,b.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var l=n.data[0],i=(0,b.getToolState)(e,x);if(i){var u=i.data[0]||{};if(u.indicesToRequest&&u.indicesToRequest.length||(u.enabled=!1),!1!==u.enabled){i.data[0].indicesToRequest.sort(function(e,t){return e-t});if(u.indicesToRequest.slice().forEach(function(e){var o=l.imageIds[e];if(o){var a=h.imageCache.getImagePromise(o);a&&"resolved"===a.state()&&t(e)}}),u.indicesToRequest.length){T.default.clearRequestStack(P);for(var s=r(u.indicesToRequest,l.currentImageIdIndex),d=void 0,f=void 0,c=C.default.getErrorLoadingHandler(),g=s.low,v=s.high;g>0||v<u.indicesToRequest.length;)g>=0&&(f=u.indicesToRequest[g--],d=l.imageIds[f],T.default.addRequest(e,d,P,!1,o,a)),v<u.indicesToRequest.length&&(f=u.indicesToRequest[v++],d=l.imageIds[f],T.default.addRequest(e,d,P,!1,o,a));T.default.startGrabbing()}}}}}function i(e,t){var o=e.data.element,a=void 0;try{a=(0,b.getToolState)(o,"stack")}catch(e){return}if(a&&a.data&&a.data.length){var n=a.data[0],r=n.imageIds.indexOf(t.imageId);if(!(r<0)){var l=(0,b.getToolState)(o,x);l&&l.data&&l.data.length&&l.data[0].indicesToRequest.push(r)}}}function u(e){clearTimeout(S),S=setTimeout(function(){var t=e.target;try{l(t)}catch(e){return}},I)}function s(e){(0,b.getToolState)(e,x).data=[];var t=(0,b.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var o=t.data[0];if(!0===o.preventCache)return void console.warn("A stack that should not be cached was given the stackPrefetch");var a={indicesToRequest:n(0,o.imageIds.length-1),enabled:!0,direction:1},r=a.indicesToRequest.indexOf(o.currentImageIdIndex);a.indicesToRequest.splice(r,1),(0,b.addToolState)(e,x,a),l(e),(0,v.default)(e).off("CornerstoneNewImage",u),(0,v.default)(e).on("CornerstoneNewImage",u),(0,v.default)(h.events).off("CornerstoneImageCachePromiseRemoved",i),(0,v.default)(h.events).on("CornerstoneImageCachePromiseRemoved",{element:e},i)}}function d(e){clearTimeout(S),(0,v.default)(e).off("CornerstoneNewImage",u),(0,v.default)(h.events).off("CornerstoneImageCachePromiseRemoved",i);var t=(0,b.getToolState)(e,x);t&&t.data.length&&(t.data[0].enabled=!1,T.default.clearRequestStack(P))}function f(){return w}function c(e){w=e,e.maxSimultaneousRequests&&(0,M.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}Object.defineProperty(t,"__esModule",{value:!0});var g=o(1),v=a(g),m=o(0),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(m),p=o(29),T=a(p),y=o(11),C=a(y),b=o(2),M=o(25),x="stackPrefetch",P="prefetch",w={},S=void 0,I=300,O=function(e){return Math.max.apply(null,e)},k=function(e){return Math.min.apply(null,e)},_={enable:s,disable:d,getConfiguration:f,setConfiguration:c};t.default=_},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(117),n=function(e){return e&&e.__esModule?e:{default:e}}(a),r={};r.FusionRenderer=n.default,t.default=r},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=t.keyCode;if(o===s.UP||o===s.DOWN){var a=1;o===s.DOWN&&(a=-1),(0,l.default)(t.element,a)}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(38),l=a(r),i=o(40),u=a(i),s={UP:38,DOWN:40},d=(0,u.default)(n);t.default=d},function(e,t,o){"use strict";function a(e){var t={imageIdToolState:i.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var o=(0,u.getElementToolStateManager)(e);o!==i.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=o.saveToolState(),t.elementViewport[e.id]=l.getViewport(e))}),t}function n(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport"))return i.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(t){var o=document.getElementById(t);if(o&&e.elementToolState.hasOwnProperty(t)){var a=(0,u.getElementToolStateManager)(o);if(a!==i.globalImageIdSpecificToolStateManager){a.restoreToolState(e.elementToolState[t]);var n=e.elementViewport[t];l.setViewport(o,n),l.updateImage(o)}}}),e}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r),i=o(17),u=o(2),s={save:a,restore:n};t.default=s},function(e,t,o){"use strict";function a(){function e(e,t,o){!1===a.hasOwnProperty(e)&&(a[e]={});var n=a[e];!1===n.hasOwnProperty(t)&&(n[t]={data:[]}),n[t].data.push(o)}function t(e,t){if(!1!==a.hasOwnProperty(e)){var o=a[e];if(!1!==o.hasOwnProperty(t)){return o[t]}}}function o(e,t,o){if(!1!==a.hasOwnProperty(e)){var n=a[e];if(!1!==n.hasOwnProperty(t)){for(var r=n[t],l=-1,i=0;i<r.data.length;i++)r.data[i]===o&&(l=i);-1!==l&&r.data.splice(l,1)}}}var a={};return{get:t,add:e,remove:o}}Object.defineProperty(t,"__esModule",{value:!0});var n=a();t.newFrameOfReferenceSpecificToolStateManager=a,t.globalFrameOfReferenceSpecificToolStateManager=n},function(e,t,o){"use strict";function a(e,t){function o(){return l}function a(e){l=e}function n(o,a,n){if(!(e.indexOf(a)>=0))return t.add(o,a,n);!1===l.hasOwnProperty(a)&&(l[a]={data:[]}),l[a].data.push(n)}function r(o,a){return e.indexOf(a)>=0?(!1===l.hasOwnProperty(a)&&(l[a]={data:[]}),l[a]):t.get(o,a)}var l={};return{get:r,add:n,saveToolState:o,restoreToolState:a,toolState:l}}function n(e,t){var o=(0,l.getElementToolStateManager)(e);o||(o=r.globalImageIdSpecificToolStateManager);var n=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(n=n.concat(t));var u=a(n,o);i.push(u),(0,l.setElementToolStateManager)(e,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=void 0;var r=o(17),l=o(2),i=[],u={newStackSpecificToolStateManager:a,addStackStateManager:n};t.stackSpecificStateManager=u,t.newStackSpecificToolStateManager=a,t.addStackStateManager=n},function(e,t,o){"use strict";function a(e,t){function o(o,a,r){if(!(e.indexOf(a)>=0))return t.add(o,a,r);!1===n.hasOwnProperty(a)&&(n[a]={data:[]}),n[a].data.push(r)}function a(o,a){return e.indexOf(a)>=0?(!1===n.hasOwnProperty(a)&&(n[a]={data:[]}),n[a]):t.get(o,a)}var n={};return{get:a,add:o}}function n(e,t){t=t||["timeSeries"];var o=(0,l.getElementToolStateManager)(e);void 0===o&&(o=r.globalImageIdSpecificToolStateManager);var n=a(t,o);i.push(n),(0,l.setElementToolStateManager)(e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var r=o(17),l=o(2),i=[];t.addTimeSeriesStateManager=n,t.newTimeSeriesSpecificToolStateManager=a},function(e,t,o){"use strict";function a(e,t){function o(e,t){u.length&&s.length&&(d=!0,s.forEach(function(o){var a=s.indexOf(o);if(-1!==a){var n=f.imageIds.targetElements[a],r=u.indexOf(e);if(-1!==r){var i=f.imageIds.sourceElements[r],d=void 0;d=i===n?0:f.distances[i][n],c(l,e,o,t,d)}}}),d=!1)}function a(e,t){!0!==d&&o(e.currentTarget,t)}function n(e,t){var o=t.element;l.remove(o)}var l=this,u=[],s=[],d=!1,f={},c=t;this.setHandler=function(e){c=e},this.getHandler=function(){return c},this.getDistances=function(){u.length&&s.length&&(f.distances={},f.imageIds={sourceElements:[],targetElements:[]},u.forEach(function(e){var t=i.getEnabledElement(e);if(t&&t.image){var o=t.image.imageId,a=i.metaData.get("imagePlane",o);if(a&&a.imagePositionPatient){var n=a.imagePositionPatient;f.hasOwnProperty(t)||(f.distances[o]={},f.imageIds.sourceElements.push(o),s.forEach(function(t){var a=i.getEnabledElement(t);if(a&&a.image){var r=a.image.imageId;if(f.imageIds.targetElements.push(r),e!==t&&o!==r&&!f.distances[o].hasOwnProperty(r)){var l=i.metaData.get("imagePlane",r);if(l&&l.imagePositionPatient){var u=l.imagePositionPatient;f.distances[o][r]=u.clone().sub(n)}}}}),Object.keys(f.distances[o]).length||delete f.distances[o])}}}))},this.addSource=function(t){-1===u.indexOf(t)&&(u.push(t),(0,r.default)(t).on(e,a),l.getDistances(),l.updateDisableHandlers())},this.addTarget=function(e){-1===s.indexOf(e)&&(s.push(e),l.getDistances(),c(l,e,e,0),l.updateDisableHandlers())},this.add=function(e){l.addSource(e),l.addTarget(e)},this.removeSource=function(t){var n=u.indexOf(t);-1!==n&&(u.splice(n,1),(0,r.default)(t).off(e,a),l.getDistances(),o(t),l.updateDisableHandlers())},this.removeTarget=function(e){var t=s.indexOf(e);-1!==t&&(s.splice(t,1),l.getDistances(),c(l,e,e,0),l.updateDisableHandlers())},this.remove=function(e){l.removeTarget(e),l.removeSource(e)},this.getSourceElements=function(){return u},this.getTargetElements=function(){return s},this.displayImage=function(e,t,o){d=!0,i.displayImage(e,t,o),d=!1},this.setViewport=function(e,t){d=!0,i.setViewport(e,t),d=!1},this.updateDisableHandlers=function(){r.default.unique(u.concat(s)).forEach(function(e){(0,r.default)(e).off("CornerstoneElementDisabled",n),(0,r.default)(e).on("CornerstoneElementDisabled",n)})},this.destroy=function(){r.default.unique(u.concat(s)).forEach(function(e){l.remove(e)})}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l);t.default=a},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=n.getViewport(t),r=n.getViewport(o);r.scale===a.scale&&r.translation.x===a.translation.x&&r.translation.y===a.translation.y||(r.scale=a.scale,r.translation.x=a.translation.x,r.translation.y=a.translation.y,e.setViewport(o,r))}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=(0,r.getToolState)(t,"stack"),l=a.data[0],u=(0,r.getToolState)(o,"stack"),s=u.data[0],d=l.currentImageIdIndex;if((d=Math.min(Math.max(d,0),s.imageIds.length-1))!==s.currentImageIdIndex){var f=i.default.getStartLoadHandler(),c=i.default.getEndLoadHandler(),g=i.default.getErrorLoadingHandler();f&&f(o);var v=void 0;v=!0===s.preventCache?n.loadImage(s.imageIds[d]):n.loadAndCacheImage(s.imageIds[d]),v.then(function(t){var a=n.getViewport(o);s.currentImageIdIndex=d,e.displayImage(o,t,a),c&&c(o,t)},function(e){var t=s.imageIds[d];g&&g(o,t,e)})}}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),r=o(2),l=o(11),i=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,l){if(o!==t){var u=n.getEnabledElement(t),s=n.metaData.get("imagePlane",u.image.imageId),d=s.imagePositionPatient,f=(0,r.getToolState)(o,"stack"),c=f.data[0],g=Number.MAX_VALUE,v=-1;if(l){var m=d.clone().add(l);if(c.imageIds.forEach(function(e,t){var o=n.metaData.get("imagePlane",e),a=o.imagePositionPatient,r=m.distanceToSquared(a);r<g&&(g=r,v=t)}),v!==c.currentImageIdIndex&&-1!==v){var h=i.default.getStartLoadHandler(),p=i.default.getEndLoadHandler(),T=i.default.getErrorLoadingHandler();h&&h(o);var y=void 0;y=!0===c.preventCache?n.loadImage(c.imageIds[v]):n.loadAndCacheImage(c.imageIds[v]),y.then(function(t){var a=n.getViewport(o);c.currentImageIdIndex=v,e.displayImage(o,t,a),p&&p(o,t)},function(e){var t=c.imageIds[v];T&&T(o,t,e)})}}}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),r=o(2),l=o(11),i=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=i.getEnabledElement(t).image,n=i.metaData.get("imagePlane",a.imageId),l=n.imagePositionPatient,s=(0,u.getToolState)(o,"stack"),f=s.data[0],c=Number.MAX_VALUE,g=-1;if(r.default.each(f.imageIds,function(e,t){var o=i.metaData.get("imagePlane",t),a=o.imagePositionPatient,n=a.distanceToSquared(l);n<c&&(c=n,g=e)}),g!==f.currentImageIdIndex){var v=d.default.getStartLoadHandler(),m=d.default.getEndLoadHandler(),h=d.default.getErrorLoadingHandler();if(v&&v(o),-1!==g){var p=void 0;p=!0===f.preventCache?i.loadImage(f.imageIds[g]):i.loadAndCacheImage(f.imageIds[g]),p.then(function(t){var a=i.getViewport(o);f.currentImageIdIndex=g,e.displayImage(o,t,a),m&&m(o,t)},function(e){var t=f.imageIds[g];h&&h(o,t,e)})}}}};var n=o(1),r=a(n),l=o(0),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(l),u=o(2),s=o(11),d=a(s)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a){if(t!==o&&a&&a.direction){var l=(0,r.getToolState)(o,"stack"),u=l.data[0],s=u.currentImageIdIndex+a.direction;if(s=Math.min(Math.max(s,0),u.imageIds.length-1),u.currentImageIdIndex!==s){var d=i.default.getStartLoadHandler(),f=i.default.getEndLoadHandler(),c=i.default.getErrorLoadingHandler();d&&d(o);var g=void 0;g=!0===u.preventCache?n.loadImage(u.imageIds[s]):n.loadAndCacheImage(u.imageIds[s]),g.then(function(t){var a=n.getViewport(o);u.currentImageIdIndex=s,e.displayImage(o,t,a),f&&f(o,t)},function(e){var t=u.imageIds[s];c&&c(o,t,e)})}}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),r=o(2),l=o(11),i=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){o!==t&&n.updateImage(o)};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){if(o!==t){var a=n.getViewport(t),r=n.getViewport(o);r.voi.windowWidth===a.voi.windowWidth&&r.voi.windowCenter===a.voi.windowCenter&&r.invert===a.invert||(r.voi.windowWidth=a.voi.windowWidth,r.voi.windowCenter=a.voi.windowCenter,r.invert=a.invert,e.setViewport(o,r))}};var a=o(0),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=[];e.timeSeries.stacks.forEach(function(o){var a=void 0;a=!0===o.preventCache?u.loadImage(o.imageIds[e.imageIdIndex]):u.loadAndCacheImage(o.imageIds[e.imageIdIndex]),a.then(function(o){var a=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*o.width,n=o.getPixelData()[a];t.push(n)})}),e.lineSample.set(t)}function r(e){var t=(0,m.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var o=t.data[0],a={timeSeries:o,lineSample:new y.default,imageIdIndex:o.stacks[o.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return n(a),p.default.add(a),a}}function l(e,t){var o=(0,m.getToolState)(e.currentTarget,C);if(o){var a=t.canvasContext.canvas.getContext("2d");u.setToPixelCoordinateSystem(t.enabledElement,a);for(var n=0;n<o.data.length;n++){a.save();var r=o.data[n];a.beginPath(),(0,c.default)(a,t,r.handles,"white"),a.stroke();var l=(0,v.default)(t.enabledElement,t.canvasContext,15);a.font=l.fontSize+"px Arial";var i=Math.round(r.handles.end.x),s=Math.round(r.handles.end.y),d=r.handles.end.x+3,f=r.handles.end.y-3;a.fillStyle="white",a.fillText(i+","+s,d,f),a.restore()}}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(i),s=o(8),d=a(s),f=o(9),c=a(f),g=o(54),v=a(g),m=o(2),h=o(113),p=a(h),T=o(112),y=a(T),C="probe4D",b=(0,d.default)({createNewMeasurement:r,onImageRendered:l,toolType:C});t.default=b},function(e,t,o){"use strict";function a(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var o=(0,r.getToolState)(e,"timeSeries");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){var a=(0,r.getToolState)(e,u),n=void 0;void 0===a||0===a.data.length?(n={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,r.addToolState)(e,u,n)):(n=a.data[0],n.framesPerSecond=t),void 0===n.intervalId&&(n.intervalId=setInterval(function(){n.framesPerSecond>0?(0,i.default)(e,1,!0):(0,i.default)(e,-1,!0)},1e3/Math.abs(n.framesPerSecond)))}}function n(e){var t=(0,r.getToolState)(e,u);if(t&&t.data&&t.data.length){var o=t.data[0];clearInterval(o.intervalId),o.intervalId=void 0}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(2),l=o(31),i=function(e){return e&&e.__esModule?e:{default:e}}(l),u="timeSeriesPlayer",s={start:a,stop:n};t.default=s},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){(0,d.default)(t.element).off("CornerstoneToolsMouseDrag",l),(0,d.default)(t.element).off("CornerstoneToolsMouseUp",n),(0,d.default)(t.element).off("CornerstoneToolsMouseClick",n)}function r(e,t){if((0,C.default)(t.which,e.data.mouseButtonMask)){var o={deltaY:0,options:e.data.options};return(0,d.default)(t.element).on("CornerstoneToolsMouseDrag",o,l),(0,d.default)(t.element).on("CornerstoneToolsMouseUp",n),(0,d.default)(t.element).on("CornerstoneToolsMouseClick",n),e.stopImmediatePropagation(),!1}}function l(e,t){e.data.deltaY+=t.deltaPoints.page.y;var o=(0,b.getToolState)(t.element,"timeSeries");if(void 0!==o&&void 0!==o.data&&0!==o.data.length){var a=o.data[0],n=(0,d.default)(t.element).height()/a.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(n=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=n||e.data.deltaY<=-n){var r=Math.round(e.data.deltaY/n),l=e.data.deltaY%n;(0,T.default)(t.element,r),e.data.deltaY=l}return!1}}function i(e,t){var o=-t.direction;(0,T.default)(t.element,o)}function u(e){var t=e.originalEvent.detail,o={deltaY:0};o.deltaY+=t.deltaPoints.page.y;var a=(0,b.getToolState)(t.element,"stack");if(void 0!==a&&void 0!==a.data&&0!==a.data.length){if(o.deltaY>=3||o.deltaY<=-3){var n=o.deltaY/3,r=o.deltaY%3;(0,T.default)(o.element,n),o.deltaY=r}return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var s=o(1),d=a(s),f=o(14),c=a(f),g=o(12),v=a(g),m=o(21),h=a(m),p=o(31),T=a(p),y=o(4),C=a(y),b=o(2),M=(0,c.default)(r),x=(0,h.default)(i),P=(0,v.default)(u);t.timeSeriesScroll=M,t.timeSeriesScrollWheel=x,t.timeSeriesScrollTouchDrag=P},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="0.9.0"},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(120),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a);t.default=n},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(86);Object.defineProperty(t,"metaData",{enumerable:!0,get:function(){return a(n).default}});var r=o(88);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return a(r).default}});var l=o(46);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return a(l).default}});var i=o(29);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return a(i).default}});var u=o(54);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return a(u).default}});var s=o(53);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return a(s).default}});var d=o(38);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return a(d).default}});var f=o(37);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return a(f).default}});var c=o(36);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return c.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return c.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return c.planePlaneIntersection}});var g=o(19);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return a(g).default}});var v=o(35);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return a(v).default}});var m=o(34);Object.defineProperty(t,"pauseEvent",{enumerable:!0,get:function(){return a(m).default}});var h=o(4);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return a(h).default}});var p=o(33);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return a(p).default}});var T=o(25);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return T.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return T.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return T.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return T.isMobileDevice}});var y=o(52);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return a(y).default}});var C=o(7);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return a(C).default}});var b=o(51);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return a(b).default}});var M=o(50);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return a(M).default}});var x=o(49);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return a(x).default}});var P=o(32);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return a(P).default}});var w=o(18);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return a(w).default}});var S=o(48);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return a(S).default}});var I=o(106);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return a(I).default}});var O=o(31);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return a(O).default}});var k=o(107);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return a(k).default}});var _=o(108);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return _.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return _.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return _.timeSeriesScrollTouchDrag}});var D=o(105);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return a(D).default}});var j=o(104);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return a(j).default}});var E=o(98);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return a(E).default}});var R=o(103);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return a(R).default}});var A=o(102);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return a(A).default}});var B=o(101);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return a(B).default}});var N=o(100);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return a(N).default}});var H=o(99);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return a(H).default}});var V=o(6);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return a(V).default}});var W=o(2);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return W.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return W.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return W.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return W.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return W.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return W.getElementToolStateManager}});var L=o(30);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return a(L).default}});var Y=o(5);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return a(Y).default}});var F=o(97);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return F.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return F.newTimeSeriesSpecificToolStateManager}});var z=o(15);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return a(z).default}});var U=o(96);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return U.stackSpecificStateManager}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return U.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return U.addStackStateManager}});var X=o(11);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return a(X).default}});var q=o(17);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return q.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return q.globalImageIdSpecificToolStateManager}});var K=o(95);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return K.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return K.globalFrameOfReferenceSpecificToolStateManager}});var G=o(94);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return a(G).default}});var Z=o(93);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return a(Z).default}});var $=o(47);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return $.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return $.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return $.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return $.stackScrollMultiTouch}});var J=o(91);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return a(J).default}});var Q=o(90);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return a(Q).default}});var ee=o(92);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return a(ee).default}});var te=o(89);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return te.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return te.stopClip}});var oe=o(13);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return a(oe).default}});var ae=o(9);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return a(ae).default}});var ne=o(16);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return a(ne).default}});var re=o(27);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return a(re).default}});var le=o(28);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return a(le).default}});var ie=o(22);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return a(ie).default}});var ue=o(23);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return a(ue).default}});var se=o(24);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return a(se).default}});var de=o(44);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return a(de).default}});var fe=o(45);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return a(fe).default}});var ce=o(82);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return a(ce).default}});var ge=o(83);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return a(ge).default}});var ve=o(84);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return a(ve).default}});var me=o(43);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return a(me).default}});var he=o(85);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return a(he).default}});var pe=o(57);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return pe.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return pe.angleTouch}});var Te=o(58);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return Te.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return Te.arrowAnnotateTouch}});var ye=o(59);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return ye.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return ye.crosshairsTouch}});var Ce=o(20);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return a(Ce).default}});var be=o(39);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return a(be).default}});var Me=o(60);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return a(Me).default}});var xe=o(61);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return xe.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return xe.dragProbeTouch}});var Pe=o(62);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return Pe.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return Pe.ellipticalRoiTouch}});var we=o(63);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return we.freehand}});var Se=o(64);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return Se.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return Se.highlightTouch}});var Ie=o(65);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return a(Ie).default}});var Oe=o(40);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return a(Oe).default}});var ke=o(66);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return ke.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return ke.lengthTouch}});var _e=o(67);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return _e.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return _e.magnifyTouchDrag}});var De=o(41);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return a(De).default}});var je=o(8);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return a(je).default}});var Ee=o(21);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return a(Ee).default}});var Re=o(26);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return a(Re).default}});var Ae=o(68);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return a(Ae).default}});var Be=o(69);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return Be.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return Be.panTouchDrag}});var Ne=o(70);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return a(Ne).default}});var He=o(71);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return He.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return He.probeTouch}});var Ve=o(72);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Ve.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Ve.rectangleRoiTouch}});var We=o(73);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return We.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return We.rotateTouchDrag}});var Le=o(74);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return a(Le).default}});var Ye=o(75);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return a(Ye).default}});var Fe=o(76);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return Fe.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return Fe.seedAnnotateTouch}});var ze=o(77);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return ze.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return ze.simpleAngleTouch}});var Ue=o(14);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return a(Ue).default}});var Xe=o(78);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return Xe.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return Xe.textMarkerTouch}});var qe=o(12);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return a(qe).default}});var Ke=o(42);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return a(Ke).default}});var Ge=o(10);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return a(Ge).default}});var Ze=o(79);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Ze.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Ze.wwwcTouchDrag}});var $e=o(80);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return $e.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return $e.wwwcRegionTouch}});var Je=o(81);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return Je.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return Je.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return Je.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return Je.zoomTouchDrag}});var Qe=o(87);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return Qe.brush}});var et=o(109);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return a(et).default}})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this;e.samples=[],this.set=function(t){e.samples=t,(0,n.default)(e).trigger("CornerstoneLineSampleUpdated")}};var a=o(1),n=function(e){return e&&e.__esModule?e:{default:e}}(a)},function(e,t,o){"use strict";function a(){var e=this;e.measurements=[],this.add=function(t){var o=e.measurements.push(t),a={index:o,measurement:t};(0,r.default)(e).trigger("CornerstoneMeasurementAdded",a)},this.remove=function(t){var o=e.measurements[t];e.measurements.splice(t,1);var a={index:t,measurement:o};(0,r.default)(e).trigger("CornerstoneMeasurementRemoved",a)}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=new a;t.default=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t="",o=e.x<0?"R":"L",a=e.y<0?"A":"P",r=e.z<0?"F":"H",l=new n.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),i=0;i<3;i++)if(l.x>1e-4&&l.x>l.y&&l.x>l.z)t+=o,l.x=0;else if(l.y>1e-4&&l.y>l.x&&l.y>l.z)t+=a,l.y=0;else{if(!(l.z>1e-4&&l.z>l.x&&l.z>l.y))break;t+=r,l.z=0}return t};var a=o(3),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=t.replace("F","h"),t=t.replace("R","l"),t=t.replace("L","r"),t=t.replace("A","p"),t=t.replace("P","a"),t=t.toUpperCase()}},function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o=(0,f.getToolState)(e.currentTarget,v);if(void 0!==o){var a=o.data[0].synchronizationContext,n=a.getSourceElements(),r=o.data[0].renderer,l=t.canvasContext.canvas.getContext("2d");d.setToPixelCoordinateSystem(t.enabledElement,l),u.default.each(n,function(o,a){a!==e.currentTarget&&r(l,t,e.currentTarget,a)})}}function r(e,t,o){o=o||g.default,(0,f.addToolState)(e,v,{synchronizationContext:t,renderer:o}),(0,u.default)(e).on("CornerstoneImageRendered",n),d.updateImage(e)}function l(e){(0,u.default)(e).off("CornerstoneImageRendered",n),d.updateImage(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=o(1),u=a(i),s=o(0),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(s),f=o(2),c=o(56),g=a(c),v="referenceLines",m={enable:r,disable:l};t.default=m},function(e,t,o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),r=o(0),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(r),i=function(){function e(){a(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return n(e,[{key:"render",value:function(e,t){var o=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");var a=t[0],n=a.imageIds[this.currentImageIdIndex];l.loadAndCacheImage(n).then(function(r){if(o.layerIds&&o.layerIds[0]){var i=o.layerIds[0],u=l.getLayer(e,i);if(void 0===u)return;u.image=Object.assign({},r)}else{var s=l.addLayer(e,Object.assign({},r),a.options);o.layerIds.push(s)}l.displayImage(e,r),t.slice(1,t.length).forEach(function(t,a){var r=o.findImageFn(t.imageIds,n,1);r&&l.loadAndCacheImage(r).then(function(n){var r=a+1;if(o.layerIds&&o.layerIds[r]){var i=o.layerIds[r],u=l.getLayer(e,i);if(void 0===u)return;u.image=Object.assign({},n)}else{var s=l.addLayer(e,Object.assign({},n),t.options);o.layerIds.push(s)}l.updateImage(e,!0)})})})}}]),e}();t.default=i},function(t,o){t.exports=e},function(e,o){e.exports=t},function(e,t){e.exports=o},function(e,t){e.exports=a}])});
//# sourceMappingURL=cornerstoneTools.min.js.map