<!DOCTYPE HTML>
<html>

<head>
	<!-- support for mobile touch devices -->
	<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
	<style>
		#app {
			font-family: "Avenir", Helvetica, Arial, sans-serif;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
			text-align: center;
			color: #333;
			margin-top: 60px;
		}

		.wrapper,
		.canvas {
			width: 512px;
			margin: 0 auto;
			height: 512px;
      padding-bottom: 10px;
		}

		label {
			text-transform: uppercase;
			margin: 0.5em 1em;
			border: 0;
			background: transparent;
			outline: 0;
			cursor: pointer;
		}

	</style>
</head>

<body>
	<div id="app">
		<h1>
			Updated API Concept : ScaleOverlay v3
		</h1>

		<div class="wrapper" oncontextmenu="return false" unselectable="on" onselectstart="return false" onmousedown="return false">
      <label for="enabled">Enabled</label>
      <input type="radio" id="enabled" value="enabled" name="scaleOverlay"/>
      <label for="disabled">Disabled</label>
			<input type="radio" id="disabled" value="disabled" name="scaleOverlay"/>

			<div class="canvas" oncontextmenu="return false" />
		</div>
	</div>
</body>



<!-- include the hammer.js library for touch gestures-->
<script src="../hammer.min.js"></script>

<!-- include the cornerstone library -->
<script src="../cornerstone.min.js"></script>

<script src="../cornerstoneMath.min.js"></script>


<!-- include the cornerstone tools library -->
<script src="../../dist/cornerstoneTools.js"></script>
<script>window.cornerstoneTools || document.write('<script src="https://unpkg.com/cornerstone-tools">\x3C/script>')</script>

<!-- include special code for these examples which provides images -->
<script src="../exampleImageLoader.js"></script>

<script>
	const cTools = cornerstoneTools.init();
	const imageId = 'example://1';
	var element = document.getElementsByClassName('canvas')[0];


	// TODO: if we emitted an event when this happened, cornerstone-tools
	// TODO: could use it to init itself
	cornerstone.enable(element);
	cTools.addCanvas(element);

	cornerstone.loadImage(imageId).then(function (image) {
		cornerstone.displayImage(element, image);
	});

	function setAllToolsPassive() {
		cTools.store.state.tools.forEach((tool) => {
			cTools.setToolPassive(element, tool.name)
		})
	}

	const tools = [
		'zoomTool',
		'scaleOverlayTool'
	];
	tools.forEach(toolName => {
		// Add the tool
		const apiTool = cornerstoneTools[toolName];
		if (apiTool) {
			const tool = new apiTool();
			cTools.addTool(element, tool);
		}
	});

  const switchBtn = document.querySelectorAll('[name="scaleOverlay"]');
  Array.from(switchBtn).forEach( btn => {
    btn.addEventListener('click', (evt) => {
      if(evt.currentTarget.value === 'enabled') {
        cTools.setToolEnabled(element, 'scaleOverlay');
      } else {
        cTools.setToolDisabled(element, 'scaleOverlay');
      }
    });
  });

	// Activate first tool
	cTools.setToolActive(element, 'zoom', { mouseButtonMask: 4 });
</script>

</html>